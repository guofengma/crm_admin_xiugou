webpackJsonp([31],{"2StV":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("FMx0"),o=a("5fic"),n=a("V3Ru"),s=a("0xDb"),i=a.n(s),l=a("UU1J"),c=a("PJh5"),u=a.n(c),p=a("go8C"),d={props:["name"],components:{icon:l.a,vRemark:p.a},data:function(){return{contents:["订单实付款金额=总订单付款金额-退款金额","成交订单数=总订单数-退款/退货订单数","付款人数=总付款人数-退款/退货人数","删除活动归还库存时间=手动关闭时间+订单关闭时间+5分钟"],p:{operatorAddDepreciate:!1,operatorUpdateDepreciatelist_1:!1,operatorUpdateDepreciatelist_2:!1,operatorUpdateDepreciatelist_3:!1,operatorUpdateDepreciatelist_4:!1,operatorfindById:!1},showOpr:!0,endStyleArr:[{label:"全部",value:""},{label:"库存售完",value:"3"},{label:"时间结束",value:"4"},{label:"手动结束",value:"5"}],createUserList:[],form:{releaseDate:"",startDate:"",activityCode:"",userId:"",productCode:"",productName:"",tstatus:""},tableData:[],tableLoading:!1,page:{currentPage:1,totalPage:0,pageSize:20},showMask:!1,btnLoading:!1,showInf:[{title:"删除确认",tip:"确定要删除此活动？",result:"一旦删除，不能撤回"},{title:"结束确认",tip:"确定要结束此活动？",result:"一旦结束，不能再开启"},{title:"下架确认",tip:"确定要下架此活动？",result:"一旦下架，不能再开启"}],index:"",id:"",inventoryMask:!1,inventory:"",number:"",notEnough:!1}},computed:{depStaName:function(){switch(this.name){case"allDepreciate":return"";case"notStart":return"1";case"starting":return"2";case"ended":return"3"}}},created:function(){this.submitForm(1),this.pControl(),this.getCreateUserList()},activated:function(){this.submitForm(1),this.pControl(),this.getCreateUserList()},methods:{pControl:function(){for(var t in this.p)this.p[t]=i.a.pc(n[t]);this.p.operatorUpdateDepreciatelist_1||this.p.operatorUpdateDepreciatelist_2||this.p.operatorUpdateDepreciatelist_3||this.p.operatorUpdateDepreciatelist_4||this.p.operatorfindById||(this.showOpr=!1)},getCreateUserList:function(){var t=this;this.$axios.post(o.r,{}).then(function(e){t.createUserList=[],t.createUserList=e.data.data}).catch(function(t){})},submitForm:function(t){var e=this,a={};a.productName=this.form.productName,a.activityCode=this.form.activityCode,a.userId=this.form.userId,a.productCode=this.form.productCode,a.startTime=this.form.startDate?u()(this.form.startDate[0]).format("YYYY-MM-DD HH:mm:ss"):"",a.startEndTime=this.form.startDate?u()(this.form.startDate[1]).format("YYYY-MM-DD HH:mm:ss"):"",a.releaseTimebegins=this.form.releaseDate?u()(this.form.releaseDate[0]).format("YYYY-MM-DD"):"",a.releaseTimeEnd=this.form.releaseDate?u()(this.form.releaseDate[1]).format("YYYY-MM-DD"):"",a.page=t,a.pageSize=this.page.pageSize,3==this.depStaName?(a.bstatus=1,a.pstatus=2):a.status=this.depStaName,a.tstatus=this.form.tstatus,this.page.currentPage=t,this.tableLoading=!0,this.$axios.post(o.o,a).then(function(t){e.tableData=[],e.tableData=t.data.data.data,e.page.totalPage=t.data.data.resultCount,e.tableLoading=!1}).catch(function(t){e.tableLoading=!1})},resetForm:function(t){this.$refs[t].resetFields(),this.form.startDate="",this.form.releaseDate="",this.submitForm(1)},handleSizeChange:function(t){console.log("每页 "+t+" 条")},handleCurrentChange:function(t){this.submitForm(t)},addDepreciate:function(){this.$router.push({name:"addDepreciate"})},endOrDelete:function(t,e){this.index=t,this.showMask=!0,this.id=e.id},closeMask:function(t){if(t){var e={};0==this.index?(e.status=this.index,e.url=n.operatorUpdateDepreciatelist_1):1==this.index?(e.status=5,e.url=n.operatorUpdateDepreciatelist_2):(e.status=6,e.url=n.operatorUpdateDepreciatelist_4),this.changeStatus(e)}else this.showMask=!1},changeStatus:function(t){var e=this;t.id=this.id,this.btnLoading=!0,this.$axios.post(o.p,t).then(function(t){e.submitForm(e.page.currentPage),e.showMask=!1,e.inventoryMask=!1,e.btnLoading=!1}).catch(function(t){e.btnLoading=!1})},toDetail:function(t){sessionStorage.setItem("id",t.id),this.$router.push({path:"/depreciateInfo",query:{id:t.id}})},deInventory:function(t){this.inventoryMask=!0,this.notEnough=!1,this.number="",this.id=t.id,this.inventory=t.totalNumber-t.freezeNumber},calInventory:function(){if(this.inventory<this.number)return this.notEnough=!0,!1;return!!/^[1-9]*[1-9][0-9]*$/.test(this.number)||(this.$message.warning("请输入正整数!"),this.number,!1)},sure:function(){if(this.calInventory()){var t={id:this.id,freezeNumber:this.number,url:n.operatorUpdateDepreciatelist_3};this.changeStatus(t)}}}},m={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tab-content"},[t.p.operatorAddDepreciate?a("el-button",{staticClass:"add-product",attrs:{type:"primary"},on:{click:t.addDepreciate}},[t._v("新建降价拍\n    ")]):t._e(),t._v(" "),a("div",{staticClass:"search-pane"},[a("el-form",{ref:"form",attrs:{model:t.form,inline:"","label-width":"100px"}},[a("el-form-item",{attrs:{prop:"productName",label:"产品名称"}},[a("el-input",{attrs:{placeholder:"请输入产品名称"},model:{value:t.form.productName,callback:function(e){t.$set(t.form,"productName","string"==typeof e?e.trim():e)},expression:"form.productName"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"productCode",label:"产品ID"}},[a("el-input",{attrs:{placeholder:"请输入产品ID"},model:{value:t.form.productCode,callback:function(e){t.$set(t.form,"productCode","string"==typeof e?e.trim():e)},expression:"form.productCode"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"activityCode",label:"产品编号"}},[a("el-input",{attrs:{placeholder:"请输入产品编号"},model:{value:t.form.activityCode,callback:function(e){t.$set(t.form,"activityCode","string"==typeof e?e.trim():e)},expression:"form.activityCode"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"startDate",label:"起拍时间"}},[a("el-date-picker",{attrs:{type:"datetimerange","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.form.startDate,callback:function(e){t.$set(t.form,"startDate",e)},expression:"form.startDate"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"tstatus",label:"结束方式"}},[a("el-select",{attrs:{placeholder:"全部"},model:{value:t.form.tstatus,callback:function(e){t.$set(t.form,"tstatus",e)},expression:"form.tstatus"}},t._l(t.endStyleArr,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("el-form-item",{attrs:{prop:"userId",label:"发布人"}},[a("el-select",{attrs:{placeholder:"全部"},model:{value:t.form.userId,callback:function(e){t.$set(t.form,"userId",e)},expression:"form.userId"}},[a("el-option",{attrs:{value:""}},[t._v("全部")]),t._v(" "),t._l(t.createUserList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})],2)],1),t._v(" "),a("el-form-item",{attrs:{prop:"releaseDate",label:"发布时间"}},[a("el-date-picker",{attrs:{type:"datetimerange",format:"yyyy-MM-dd","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.form.releaseDate,callback:function(e){t.$set(t.form,"releaseDate",e)},expression:"form.releaseDate"}})],1),t._v(" "),a("el-form-item",{attrs:{label:" "}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm(1)}}},[t._v("搜索")]),t._v(" "),a("el-button",{on:{click:function(e){t.resetForm("form")}}},[t._v("重置")])],1)],1)],1),t._v(" "),a("v-remark",{attrs:{contents:t.contents}}),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],attrs:{border:"",data:t.tableData}},[a("el-table-column",{attrs:{prop:"activityCode",align:"center",label:"编号","min-width":"100"}}),t._v(" "),a("el-table-column",{attrs:{label:"降价拍商品","min-width":"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"product-img"},[a("img",{attrs:{src:e.row.productImg}})]),t._v(" "),a("p",{staticClass:"product-inf"},[t._v(t._s(e.row.productName))]),t._v(" "),a("p",{staticClass:"product-inf",staticStyle:{"margin-top":"25px"}},[t._v("原价：￥"+t._s(e.row.productPrice))]),t._v(" "),a("p",{staticClass:"product-inf"},[t._v("产品ID："+t._s(e.row.productCode))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"productSpec",label:"规格",align:"center","min-width":"100"}}),t._v(" "),a("el-table-column",{attrs:{label:"起拍价(元)",align:"center","min-width":"60"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                ￥"+t._s(e.row.startPrice)+"\n            ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"结束价(元)",align:"center","min-width":"60"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"color-red"},[t._v("￥"+t._s(e.row.floorPrice))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"totalNumber",label:"拍卖数量",align:"center","min-width":"60"}}),t._v(" "),a("el-table-column",{attrs:{label:"预约购买人数",align:"center","min-width":"60"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.reseCount?e.row.reseCount:"0"))]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"订单实付金额",align:"center","min-width":"60"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                ￥"+t._s(e.row.payTotal?e.row.payTotal:"0")+"\n            ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"payOrderCount",label:"付款订单数",align:"center","min-width":"60"}}),t._v(" "),a("el-table-column",{attrs:{prop:"freezeNumber",label:"冻结库存",align:"center","min-width":"60"}}),t._v(" "),a("el-table-column",{attrs:{prop:"payUserTotal",label:"付款人数",align:"center","min-width":"60"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.payUserTotal?e.row.payUserTotal:"0"))]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"saleNum",label:"关闭时间",align:"center","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.closeTime?[t._v(t._s(t._f("formatDate")(e.row.closeTime)))]:t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"起拍/结束时间",align:"center","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                "+t._s(t._f("formatDate")(e.row.beginTime))),a("br"),t._v(t._s(t._f("formatDate")(e.row.endTime))+"\n            ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"发布时间/发布人",align:"center","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                "+t._s(t._f("formatDate")(e.row.createTime))),a("br"),t._v(t._s(e.row.userAccount)+"\n            ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"",label:"状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[2==e.row.status?[t._v("进行中")]:3==e.row.status?[t._v("已结束"),a("br"),t._v("(库存售完)")]:4==e.row.status?[t._v("已结束"),a("br"),t._v("(时间结束)")]:5==e.row.status?[t._v("已结束"),a("br"),t._v("(手动结束)")]:1==e.row.status?[t._v("未开始")]:6==e.row.status?[t._v("下架隐藏")]:t._e()]}}])}),t._v(" "),t.showOpr?a("el-table-column",{attrs:{label:"操作",align:"center","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.p.operatorfindById?a("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"primary"},on:{click:function(a){t.toDetail(e.row)}}},[t._v("查看\n                ")]):t._e(),t._v(" "),1!=e.row.status&&2!=e.row.status||!t.p.operatorUpdateDepreciatelist_2?t._e():a("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"danger"},on:{click:function(a){t.endOrDelete(1,e.row)}}},[t._v("\n                    结束\n                ")]),t._v(" "),2==e.row.status&&t.p.operatorUpdateDepreciatelist_3?a("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"warning"},on:{click:function(a){t.deInventory(e.row)}}},[t._v("减少库存\n                ")]):t._e(),t._v(" "),1!=e.row.status&&2!=e.row.status&&t.p.operatorUpdateDepreciatelist_1?a("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"danger"},on:{click:function(a){t.endOrDelete(0,e.row)}}},[t._v("\n                    删除\n                ")]):t._e(),t._v(" "),3!=e.row.status&&4!=e.row.status&&5!=e.row.status||!t.p.operatorUpdateDepreciatelist_4?t._e():a("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"warning"},on:{click:function(a){t.endOrDelete(2,e.row)}}},[t._v("\n                    下架\n                ")])]}}])}):t._e()],1),t._v(" "),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{background:"","current-page":t.page.currentPage,"page-size":t.page.pageSize,layout:"total, prev, pager, next, jumper",total:t.page.totalPage},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),t._v(" "),t.showMask?a("div",{staticClass:"pwd-mask"},[a("div",{staticClass:"box"},[a("div",{staticClass:"mask-title"},[a("icon",{staticClass:"ico",attrs:{ico:"icon-jinggao"}}),t._v("\n                "+t._s(t.showInf[t.index].title)+"\n            ")],1),t._v(" "),a("div",{staticClass:"mask-content"},[a("div",{staticClass:"del-tip"},[a("div",[t._v(t._s(t.showInf[t.index].tip))]),t._v(" "),a("div",[t._v(t._s(t.showInf[t.index].result))])]),t._v(" "),a("div",{staticClass:"del-btn-group"},[a("el-button",{attrs:{loading:t.btnLoading,type:"primary"},on:{click:function(e){t.closeMask(!0)}}},[t._v("确认")]),t._v(" "),a("el-button",{on:{click:function(e){t.closeMask(!1)}}},[t._v("取消")])],1)])])]):t._e(),t._v(" "),a("el-dialog",{attrs:{title:"减少库存",visible:t.inventoryMask},on:{"update:visible":function(e){t.inventoryMask=e}}},[a("div",{staticStyle:{"text-align":"center","line-height":"50px"}},[t._v("现有库存"+t._s(t.inventory))]),t._v(" "),a("el-form",[a("el-form-item",{attrs:{prop:"name",label:"减少"}},[a("el-input",{attrs:{"auto-complete":"off"},on:{blur:t.calInventory},model:{value:t.number,callback:function(e){t.number=e},expression:"number"}}),t._v(" "),a("span",{staticClass:"tip"},[t._v("减掉的库存不可恢复")]),t._v(" "),t.notEnough?a("div",{staticClass:"tip",staticStyle:{"margin-left":"50px"}},[t._v("库存不足")]):t._e()],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{loading:t.btnLoading,type:"primary"},on:{click:t.sure}},[t._v("提交")]),t._v(" "),a("el-button",{on:{click:function(e){t.inventoryMask=!1}}},[t._v("取 消")])],1)],1)],1)},staticRenderFns:[]};var v=a("VU/8")(d,m,!1,function(t){a("Fjdy")},"data-v-2ccf97ae",null).exports,f={components:{vBreadcrumb:r.a,vTabContent:v},data:function(){return{nav:["运营管理","营销工具管理","降价拍"],activeName:"allDepreciate"}},methods:{handleClick:function(t){this.activeName=t.name}}},_={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"depreciate-list"},[a("v-breadcrumb",{attrs:{nav:t.nav}}),t._v(" "),a("el-card",{attrs:{"body-style":{padding:"30px 45px",minHeight:"80vh"}}},[a("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"全部",name:"allDepreciate"}},["allDepreciate"==t.activeName?a("v-tab-content",{attrs:{name:t.activeName}}):t._e()],1),t._v(" "),a("el-tab-pane",{attrs:{label:"未开始",name:"notStart"}},["notStart"==t.activeName?a("v-tab-content",{attrs:{name:t.activeName}}):t._e()],1),t._v(" "),a("el-tab-pane",{attrs:{label:"进行中",name:"starting"}},["starting"==t.activeName?a("v-tab-content",{attrs:{name:t.activeName}}):t._e()],1),t._v(" "),a("el-tab-pane",{attrs:{label:"已结束",name:"ended"}},["ended"==t.activeName?a("v-tab-content",{attrs:{name:t.activeName}}):t._e()],1)],1)],1)],1)},staticRenderFns:[]};var b=a("VU/8")(f,_,!1,function(t){a("LMTN")},null,null);e.default=b.exports},Fjdy:function(t,e){},LMTN:function(t,e){}});