webpackJsonp([39],{AAIs:function(i,s){},msOD:function(i,s,a){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var t=a("UU1J"),e=a("FMx0"),d=a("P9l9"),n={components:{icon:t.a},props:["productcIds","detailData","addOrUp","isLevel"],data:function(){return{value:"",brandList:[{allChecked:!1}],tempChooseList:[],chooseList:[],brandName:"",brandId:"",brandsId:[],classifyName:[],brandIndex:"0",classifyId:[],delBrandId:"",delClassifyId:[],loading:!1}},created:function(){var i=this;setTimeout(function(){"update"==i.addOrUp&&i.getHistoryClassify(),i.search(i.value)},1e3)},methods:{getHistoryClassify:function(){for(var i in this.detailData){var s=this.detailData[i].product_name,a=this.detailData[i].product_id,t=this.detailData[i].category_name,e=this.detailData[i].c_id,d={brandId:a,name:s+"-"+t,checked:!1,classifyId:e};this.tempChooseList.push({brandId:a,brandName:s}),this.classifyId.push(e),this.classifyName.push(t),this.chooseList.push(d)}},search:function(i){var s=this,a={name:i};s.loading=!0,s.$axios.post(d.getList,a).then(function(i){if(s.loading=!1,200==i.data.code){for(var a in i.data.data)i.data.data[a].checked=!1,i.data.data[0].checked=!0,i.data.data[a].allChecked=!1,i.data.data[a].classifyList=[];s.brandList=i.data.data,s.brandName=s.brandList[0].name,s.brandId=s.brandList[0].id,s.brandsId.push(s.brandList[0].id),s.getClassifyList(0,s.brandList[0].id)}else s.$message.warning(i.data.msg)}).catch(function(i){console.log(i),s.loading=!1})},getClassifyList:function(i,s){var a=this;a.brandList[i].classifyList=[];var t={fatherid:s};a.loading=!0,a.$axios.post(d.getProductCategoryList,t).then(function(s){if(a.loading=!1,200==s.data.code){if(s.data.data.length)for(var t in s.data.data){var e=s.data.data[t].id;-1==a.classifyId.indexOf(e)?(s.data.data[t].checked=!1,s.data.data[t].hasChecked=!1):(s.data.data[t].checked=!0,s.data.data[t].hasChecked=!0)}else a.brandList[i].allChecked=!0;a.brandList[i].classifyList=s.data.data,a.brandIsAllCheck(),console.log(a.brandList[i])}else a.$message.warning(s.data.msg)}).catch(function(i){console.log(i),a.loading=!1})},chooseBrand:function(i,s){this.brandName=this.brandList[s].name,this.brandIndex=s,this.brandId=i.id,-1==this.brandsId.indexOf(i.id)&&this.brandsId.push(i.id),this.$emit("brandsId",this.brandsId),this.getClassifyList(s,i.id)},chooseClassify:function(i,s){i.checked=!i.checked;var a=i.id,t=i.name;if(i.checked)this.classifyId.push(a),this.classifyName.push(t),this.tempChooseList.push({brandId:this.brandList[this.brandIndex].id,brandName:this.brandList[this.brandIndex].name});else for(var e in this.classifyId)a==this.classifyId[e]&&(this.classifyId.splice(e,1),this.classifyName.splice(e,1),this.tempChooseList.splice(e,1))},addBrandClassify:function(){for(var i in this.chooseList=[],this.tempChooseList){var s={brandId:this.tempChooseList[i].brandId,classifyId:this.classifyId[i],name:this.tempChooseList[i].brandName+"-"+this.classifyName[i],checked:!1},a=this.tempChooseList[i].brandId;-1==this.brandsId.indexOf(a)&&this.brandsId.push(a),this.chooseList.push(s),this.changeClassifyList(this.tempChooseList[i].brandId,this.classifyId[i],"add"),this.brandIsAllCheck()}this.$emit("productcIds",this.classifyId),this.$emit("brandsId",this.brandsId)},delItem:function(i,s){if(i.checked=!i.checked,this.chooseList[s].checked)-1==this.delClassifyId.indexOf(i.classifyId)&&(this.delBrandId=i.brandId,this.delClassifyId.push(i.classifyId));else for(var a in this.delClassifyId)i.classifyId==this.delClassifyId[a]&&this.delClassifyId.splice(a,1)},delBrandClassify:function(){for(var i in this.delClassifyId)for(var s in this.chooseList)this.delClassifyId[i]==this.chooseList[s].classifyId&&this.chooseList[s].checked&&(this.changeClassifyList(this.chooseList[s].brandId,this.delClassifyId[i],"del"),this.brandIsAllCheck(),this.chooseList.splice(s,1),this.tempChooseList.splice(s,1),this.classifyId.splice(s,1),this.classifyName.splice(s,1));this.$emit("productcIds",this.classifyId)},brandIsAllCheck:function(){for(var i in this.brandList){var s=0;for(var a in this.brandList[i].classifyList)this.brandList[i].classifyList[a].hasChecked&&s++,s==this.brandList[i].classifyList.length?this.brandList[i].allChecked=!0:this.brandList[i].allChecked=!1}},changeClassifyList:function(i,s,a){for(var t in this.brandList)if(this.brandList[t].id==i)for(var e in this.brandList[t].classifyList)this.brandList[t].classifyList[e].id==s&&(!this.brandList[t].classifyList[e].hasChecked&&"add"==a||this.brandList[t].classifyList[e].hasChecked&&"del"==a)&&(this.brandList[t].classifyList[e].hasChecked=!this.brandList[t].classifyList[e].hasChecked,this.brandList[t].classifyList[e].checked=!1)}}},c={render:function(){var i=this,s=i.$createElement,a=i._self._c||s;return a("div",{staticClass:"choose-box"},[a("div",{staticStyle:{"margin-top":"10px"}},[a("div",{staticClass:"check-area"},[a("div",{staticClass:"title"},[i._v("选择品牌")]),i._v(" "),a("div",[i.brandList?a("ul",{directives:[{name:"loading",rawName:"v-loading",value:i.loading,expression:"loading"}]},i._l(i.brandList,function(s,t){return a("li",{class:i.brandIndex==t?"selected":"",on:{click:function(a){i.chooseBrand(s,t)}}},[i._v(i._s(s.name)+"\n                    ")])})):i._e()])]),i._v(" "),a("div",{staticClass:"check-area"},[a("div",{staticClass:"title"},[i._v("选择品类")]),i._v(" "),i.brandList[i.brandIndex].allChecked?a("div",{staticClass:"nodata"},[i._v("\n                暂无数据~\n            ")]):a("div",[i.brandList[i.brandIndex]?a("ul",{directives:[{name:"loading",rawName:"v-loading",value:i.loading,expression:"loading"}]},i._l(i.brandList[i.brandIndex].classifyList,function(s,t){return s.hasChecked?i._e():a("li",{class:s.checked?"selected":"",on:{click:function(a){i.chooseClassify(s,t)}}},[i._v(i._s(s.name)+"\n                    ")])})):i._e()])]),i._v(" "),a("div",{staticClass:"opr-area"},[a("el-button",{attrs:{type:"primary"},on:{click:i.addBrandClassify}},[i._v("添加品类")]),i._v(" "),a("el-button",{on:{click:i.delBrandClassify}},[i._v("删除品类")])],1),i._v(" "),a("div",{staticClass:"check-area"},[a("div",{staticClass:"title"},[i._v("已选择品牌-品类")]),i._v(" "),a("div",[a("ul",i._l(i.chooseList,function(s,t){return a("li",{class:s.checked?"selected":"",on:{click:function(a){i.delItem(s,t)}}},[i._v(i._s(s.name)+"\n                    ")])}))])])])])},staticRenderFns:[]};var l=a("VU/8")(n,c,!1,function(i){a("AAIs")},"data-v-944bd634",null).exports,o=a("PJh5"),r=a.n(o),h=a("19nM"),f={components:{vBreadcrumb:e.a,icon:t.a,vChoosearea:l},data:function(){return{form:{invalidTime:"",clickTimes:"",levelId:"",inviteType:"1",invalidType:"1"},checkedList:[],statusONList:[],tabList:[{name:"线上",id:1,isIndeterminate:!1,checkAll:!1,checkedList:[],statusONList:[{name:"京东",id:3,checked:!1},{name:"天猫",id:4,checked:!1}]},{name:"线下",id:2,isIndeterminate:!1,checkAll:!1,checkedList:[],statusONList:[{name:"超市",id:5,checked:!1},{name:"便利店",id:6,checked:!1}]}],isUpdateUperMask:!1,levelList:[],num:-1,tabNum:0,tabId:"",btnLoading:!1,dateDisabled:!0,pickerOptions:{disabledDate:function(i){return i.getTime()<new Date-864e5}}}},activated:function(){this.form={},this.num=-1,this.getLevelList()},methods:{productcIds:function(i){this.form.categorys=i.join(","),console.log(this.form.categorys)},brandsId:function(i){this.form.brands=i.join(","),console.log(this.form.brands)},changeStyle:function(){1==this.form.invalidType?this.dateDisabled=!0:this.dateDisabled=!1},getLevelList:function(){var i=this;i.$axios.post(d.getLevelListWithDealerCount,{}).then(function(s){200==s.data.code?i.levelList=s.data.data:i.$message.warning(s.data.msg)}).catch(function(i){console.log(i)})},checkLevel:function(i,s){this.num=i,this.form.levelId=s},cancle:function(){this.$router.push("/joinManage")},submitForm:function(){var i=this,s={};s.levelId=i.form.levelId,s.inviteType=i.form.inviteType,s.invalidType=i.form.invalidType,1==i.form.invalidType?s.clickTimes=i.form.clickTimes:s.invalidTime=i.form.invalidTime?r()(i.form.invalidTime).format("YYYY-MM-DD HH:mm:ss"):"",s.levelId?s.inviteType?1!=i.form.invalidType||s.clickTimes?s.invalidType?2!=i.form.invalidType||s.invalidTime?(s.url=h.addInvite,i.btnLoading=!0,this.$axios.post(d.addInvite,s).then(function(s){i.btnLoading=!1,200==s.data.code?(i.$message.success(s.data.msg),setTimeout(function(){i.$router.push("/joinManage")},1e3)):i.$message.warning(s.data.msg)}).catch(function(s){console.log(s),i.btnLoading=!1})):i.$message.warning("请设置失效时间!"):i.$message.warning("请设置邀请有效期!"):i.$message.warning("请输入链接打开次数!"):i.$message.warning("请选择经销商类型!"):i.$message.warning("请选择邀请层级!")}}},m={render:function(){var i=this,s=i.$createElement,a=i._self._c||s;return a("div",[a("v-breadcrumb",{attrs:{nav:["经销商会员管理","经销商加盟管理","邀请发起"]}}),i._v(" "),a("div",{staticClass:"send-invite"},[a("div",{staticClass:"box"},[a("div",{staticClass:"mask-content"},[a("el-form",{attrs:{model:i.form}},[a("div",{staticClass:"title-item"},[i._v("邀请层级")]),i._v(" "),a("el-form-item",i._l(i.levelList,function(s,t){return a("div",{staticClass:"level-area",class:i.num==t?"checked":"",on:{click:function(a){i.checkLevel(t,s.id)}}},[a("div",{staticClass:"upper"},[a("icon",{staticClass:"icon",attrs:{ico:"icon-zhucedengluyonghuming"}}),i._v(" "),a("div",[i._v(i._s(s.name))])],1),i._v(" "),a("div",{staticClass:"downer"},[i._v("已有人数："+i._s(s.dealerNum))])])})),i._v(" "),a("div",{staticClass:"title-item"},[i._v("邀请经销商类型")]),i._v(" "),a("el-form-item",[a("el-radio-group",{model:{value:i.form.inviteType,callback:function(s){i.$set(i.form,"inviteType",s)},expression:"form.inviteType"}},[a("el-radio",{attrs:{label:"1"}},[i._v("网信经销商")]),i._v(" "),a("el-radio",{attrs:{label:"2"}},[i._v("供货经销商")]),i._v(" "),a("el-radio",{attrs:{label:"3"}},[i._v("网红经销商")])],1)],1),i._v(" "),a("div",{staticClass:"title-item"},[i._v("邀请有效期")]),i._v(" "),a("el-form-item",{staticClass:"valid-area"},[a("el-radio-group",{on:{change:i.changeStyle},model:{value:i.form.invalidType,callback:function(s){i.$set(i.form,"invalidType",s)},expression:"form.invalidType"}},[a("el-radio",{attrs:{label:"1"}},[i._v("\n                                链接打开次数\n                                "),a("el-input",{staticClass:"small-inp",model:{value:i.form.clickTimes,callback:function(s){i.$set(i.form,"clickTimes",s)},expression:"form.clickTimes"}}),i._v("\n                                次\n                            ")],1),i._v(" "),a("el-radio",{attrs:{label:"2"}},[i._v("\n                                设置失效时间\n                                "),a("el-date-picker",{attrs:{type:"datetime",disabled:i.dateDisabled,"picker-options":i.pickerOptions,placeholder:"请选择失效时间"},model:{value:i.form.invalidTime,callback:function(s){i.$set(i.form,"invalidTime",s)},expression:"form.invalidTime"}})],1)],1)],1)],1)],1),i._v(" "),a("div",{staticClass:"submit-btn"},[a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:i.btnLoading,expression:"btnLoading"}],attrs:{type:"primary"},on:{click:function(s){i.submitForm("form")}}},[i._v("确认保存")]),i._v(" "),a("el-button",{on:{click:i.cancle}},[i._v("取消")])],1)])])],1)},staticRenderFns:[]};var v=a("VU/8")(f,m,!1,function(i){a("u0EI")},null,null);s.default=v.exports},u0EI:function(i,s){}});