webpackJsonp([117],{fUom:function(t,e){},xdno:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("FMx0"),n=a("OwCO"),r=a("0xDb"),l=a.n(r),s=a("PJh5"),i=a.n(s),c=a("xnHa"),u=a("GVVA"),d={components:{vBreadcrumb:o.a},mixins:[c.b],data:function(){return{nav:["运营管理","优惠券设置","优惠券管理","券数据"],p:{addInventory:!1,loseBatchDiscountCouponDealer:!1},form:{getDate:"",date:"",status:""},tableData:[],tableLoading:!1,isShowPop:!1,multipleSelection:[],page:{currentPage:1,totalPage:0},addMask:!1,left:"",value:"",repertoryNumber:"",params:{}}},activated:function(){this.params=this.$route.query||JSON.parse(sessionStorage.getItem("couponData")),this.pControl(),this.repertoryNumber="",this.getList(1)},methods:{pControl:function(){for(var t in this.p)this.p[t]=l.a.pc(n[t])},getList:function(t){var e=this,a={page:t,status:this.form.status,discountCouponId:this.params.id,beginTime:this.form.getDate?i()(this.form.getDate[0]).format("YYYY-MM-DD"):"",endTime:this.form.getDate?i()(this.form.getDate[1]).format("YYYY-MM-DD"):"",beginStartTime:this.form.date?i()(this.form.date[0]).format("YYYY-MM-DD"):"",endStartTime:this.form.date?i()(this.form.date[1]).format("YYYY-MM-DD"):""};a.url=n.discountCouponDealerPageList,this.page.currentPage=t,this.tableLoading=!0,u.a.discountCouponDealerPageList(a).then(function(t){e.tableData=[],e.tableData=t.data.data.data,e.page.totalPage=t.data.data.resultCount,e.tableLoading=!1}).catch(function(t){console.log(t),e.tableLoading=!1})},resetForm:function(t){this.$refs[t].resetFields()},handleSelectionChange:function(t){var e=this;this.multipleSelection=[],t.forEach(function(t,a){e.multipleSelection.push(t.id)})},productInfo:function(t){sessionStorage.setItem("productInfo",t.id),this.$router.push({name:"productInfo",query:{productInfoId:t.id}})},addInventory:function(){this.addMask=!0,this.left=this.params.left,this.value=this.params.status},addRepertory:function(){var t=this,e={id:this.params.id,repertoryNumber:this.repertoryNumber};this.repertoryNumber?u.a.addRepertory(e).then(function(e){t.addMask=!1,t.getList(1)}).catch(function(e){console.log(e),t.tableLoading=!1}):this.$message.warning("请输入库存!")},batchOperate:function(){var t=this,e={};e.ids=this.multipleSelection.join(","),e.url=n.loseBatchDiscountCouponDealer,u.a.loseBatchDiscountCouponDealer(e).then(function(e){t.$message.success(e.data.data),t.isShowPop=!1,t.getList(t.page.currentPage)}).catch(function(t){console.log(t)})}}},p={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"coupon-data"},[a("v-breadcrumb",{attrs:{nav:t.nav}}),t._v(" "),a("el-card",{attrs:{"body-style":{padding:"30px 45px",minHeight:"80vh"}}},[t.p.addInventory?a("el-button",{staticClass:"add-product",attrs:{type:"primary"},on:{click:t.addInventory}},[t._v("增加券库存")]):t._e(),t._v(" "),a("div",{staticClass:"search-pane"},[a("el-form",{ref:"form",attrs:{model:t.form,inline:"","label-width":"100px"}},[a("el-form-item",{attrs:{prop:"getDate",label:"领取时间","label-width":"120"}},[a("el-date-picker",{attrs:{type:"datetimerange",format:"yyyy-MM-dd","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.form.getDate,callback:function(e){t.$set(t.form,"getDate",e)},expression:"form.getDate"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"date",label:"可用时间","label-width":"120"}},[a("el-date-picker",{attrs:{type:"datetimerange",format:"yyyy-MM-dd","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.form.date,callback:function(e){t.$set(t.form,"date",e)},expression:"form.date"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"status",label:"状态","label-width":"120"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},[a("el-option",{attrs:{label:"全部",value:""}}),t._v(" "),a("el-option",{attrs:{label:"已使用",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"未使用",value:"0"}}),t._v(" "),a("el-option",{attrs:{label:"已失效",value:"2"}}),t._v(" "),a("el-option",{attrs:{label:"未激活",value:"3"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:" "}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.getList(1)}}},[t._v("搜索")]),t._v(" "),a("el-button",{on:{click:function(e){t.resetForm("form")}}},[t._v("重置")])],1),t._v(" "),a("el-form-item",{attrs:{label:" "}},[a("el-button",{attrs:{type:"primary"},on:{click:t.addInventory}},[t._v("添加券库存")])],1)],1)],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],attrs:{border:"",data:t.tableData},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",align:"center",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{prop:"code",label:"优惠券编码"}}),t._v(" "),a("el-table-column",{attrs:{label:"领取时间",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                        "+t._s(t._f("formatDate")(e.row.createTime))+"\n                    ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"可用时间",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                        "+t._s(t._f("formatDate")(e.row.startTime))+"\n                    ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"结束时间",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                        "+t._s(t._f("ormatDate")(e.row.outTime))+"\n                    ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"nickname",label:"领取人",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"使用时间",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                        "+t._s(t._f("formatDate")(e.row.updateTime))+"\n                    ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"",label:"状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.status?[t._v("未使用")]:1==e.row.status?[t._v("已使用")]:2==e.row.status?[t._v("已失效")]:3==e.row.status?[t._v("未激活")]:t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.updateTime?a("el-button",{attrs:{type:"primary"},on:{click:function(a){t.inventoryManage(e.row)}}},[t._v("\n                                订单详情\n                            ")]):t._e()]}}])})],1),t._v(" "),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{background:"","current-page":t.page.currentPage,layout:"total, prev, pager, next, jumper",total:t.page.totalPage},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),t._v(" "),a("div",{staticClass:"operate-table"},[a("el-popover",{attrs:{placement:"top",width:"160"},model:{value:t.isShowPop,callback:function(e){t.isShowPop=e},expression:"isShowPop"}},[a("p",[t._v("确定删除吗？")]),t._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.batchOperate}},[t._v("确定")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t.isShowPop=!1}}},[t._v("取消")])],1),t._v(" "),t.p.loseBatchDiscountCouponDealer?a("el-button",{attrs:{slot:"reference"},on:{click:function(e){t.isShowPop=!0}},slot:"reference"},[t._v("删除")]):t._e()],1),t._v(" "),a("el-button",{attrs:{type:"primary"}},[t._v("导出全部")])],1)],1),t._v(" "),t.addMask?a("div",{staticClass:"mask"},[a("div",{staticClass:"content"},[a("div",{staticClass:"item"},[a("span",[t._v("剩余库存：")]),t._v(t._s(t.left)+"份")]),t._v(" "),a("div",{staticClass:"item"},[a("span",[t._v("券值：")]),t._v(t._s(t.value))]),t._v(" "),a("div",{staticClass:"item"},[a("span",[t._v("追加数量：")]),a("el-input",{model:{value:t.repertoryNumber,callback:function(e){t.repertoryNumber=e},expression:"repertoryNumber"}})],1),t._v(" "),a("div",{staticStyle:{"text-align":"center","margin-top":"30px"}},[a("el-button",{attrs:{type:"primary"},on:{click:t.addRepertory}},[t._v("确定")]),t._v(" "),a("el-button",{on:{click:function(e){t.addMask=!1}}},[t._v("取消")])],1)])]):t._e()],1)},staticRenderFns:[]};var m=a("VU/8")(d,p,!1,function(t){a("fUom")},null,null);e.default=m.exports}});