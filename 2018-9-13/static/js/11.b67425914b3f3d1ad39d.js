webpackJsonp([11],{"/ddM":function(s,a,i){"use strict";var e=i("UU1J"),t=i("P9l9"),d={components:{icon:e.a},props:["productcIds","detailData","addOrUp","isSearch","isSupplider"],data:function(){return{value:"",brandList:[{allChecked:!1}],tempChooseList:[],chooseList:[],brandName:"",brandId:"",classifyName:[],brandIndex:"0",classifyId:[],delBrandId:"",delClassifyId:[],loading:!1}},watch:{detailData:function(s){s&&(this.getHistoryClassify(),this.search(this.value))}},activated:function(){"update"!=this.addOrUp&&(this.search(this.value),this.chooseList=[],this.tempChooseList=[],this.value="",this.brandList=[{allChecked:!1}],this.brandName="",this.brandId="",this.delBrandId="",this.classifyName=[],this.brandIndex="0",this.classifyId=[],this.delClassifyId=[])},created:function(){},methods:{getHistoryClassify:function(){if(this.chooseList=[],this.classifyId=[],this.classifyName=[],this.tempChooseList=[],this.isSupplider){for(var s in this.detailData){var a=this.detailData[s].p_name,i=this.detailData[s].fatherid||this.detailData[s].first_category_id,e=this.detailData[s].name,t=this.detailData[s].sec_category_id,d={brandId:i,name:a+"-"+e,checked:!1,classifyId:t};this.tempChooseList.push({brandId:i,brandName:a}),this.classifyId.push(t),this.classifyName.push(e),this.chooseList.push(d)}var n=[];for(var r in this.tempChooseList){var o={firstCategoryId:this.tempChooseList[r].brandId,secCategoryId:this.classifyId[r]};n.push(o)}this.$emit("productcIds",n)}else{for(var l in this.detailData){var c=this.detailData[l].product_name,h=this.detailData[l].product_id,f=this.detailData[l].category_name,m=this.detailData[l].c_id,u={brandId:h,name:c+"-"+f,checked:!1,classifyId:m};this.tempChooseList.push({brandId:h,brandName:c}),this.classifyId.push(m),this.classifyName.push(f),this.chooseList.push(u)}this.$emit("productcIds",this.classifyId)}},search:function(s){var a=this,i={name:s};a.loading=!0,a.$axios.post(t.getFirstList,i).then(function(s){if(a.loading=!1,200==s.data.code){for(var i in s.data.data)s.data.data[i].checked=!1,s.data.data[0].checked=!0,s.data.data[i].allChecked=!1,s.data.data[i].classifyList=[];a.brandList=s.data.data,a.brandName=a.brandList[0].name,a.brandId=a.brandList[0].id,a.getClassifyList(0,a.brandList[0].id)}else a.$message.warning(s.data.msg)}).catch(function(s){console.log(s),a.loading=!1})},getClassifyList:function(s,a){var i=this;i.brandList[s].classifyList=[];var e={fatherid:a};i.loading=!0,i.$axios.post(t.getSecondList,e).then(function(a){if(i.loading=!1,200==a.data.code){if(a.data.data.length)for(var e in a.data.data){var t=a.data.data[e].id;-1==i.classifyId.indexOf(t)?(a.data.data[e].checked=!1,a.data.data[e].hasChecked=!1):(a.data.data[e].checked=!0,a.data.data[e].hasChecked=!0)}else i.brandList[s].allChecked=!0;i.brandList[s].classifyList=a.data.data,i.brandIsAllCheck()}else i.$message.warning(a.data.msg)}).catch(function(s){console.log(s),i.loading=!1})},chooseBrand:function(s,a){this.brandName=this.brandList[a].name,this.brandIndex=a,this.brandId=s.id,this.getClassifyList(a,s.id)},chooseClassify:function(s,a){s.checked=!s.checked;var i=s.id,e=s.name;if(s.checked)this.classifyId.push(i),this.classifyName.push(e),this.tempChooseList.push({brandId:this.brandList[this.brandIndex].id,brandName:this.brandList[this.brandIndex].name});else for(var t in this.classifyId)i==this.classifyId[t]&&(this.classifyId.splice(t,1),this.classifyName.splice(t,1),this.tempChooseList.splice(t,1))},addBrandClassify:function(){for(var s in this.chooseList=[],this.tempChooseList){var a={brandId:this.tempChooseList[s].brandId,classifyId:this.classifyId[s],name:this.tempChooseList[s].brandName+"-"+this.classifyName[s],checked:!1};this.chooseList.push(a),this.changeClassifyList(this.tempChooseList[s].brandId,this.classifyId[s],"add"),this.brandIsAllCheck()}if(this.isSupplider){var i=[];for(var e in this.tempChooseList){var t={firstCategoryId:this.tempChooseList[e].brandId,secCategoryId:this.classifyId[e]};i.push(t)}this.$emit("productcIds",i)}else this.$emit("productcIds",this.classifyId)},delItem:function(s,a){if(s.checked=!s.checked,this.chooseList[a].checked)-1==this.delClassifyId.indexOf(s.classifyId)&&(this.delBrandId=s.brandId,this.delClassifyId.push(s.classifyId));else for(var i in this.delClassifyId)s.classifyId==this.delClassifyId[i]&&this.delClassifyId.splice(i,1)},delBrandClassify:function(){for(var s in this.delClassifyId)for(var a in this.chooseList)this.delClassifyId[s]==this.chooseList[a].classifyId&&this.chooseList[a].checked&&(this.changeClassifyList(this.chooseList[a].brandId,this.delClassifyId[s],"del"),this.brandIsAllCheck(),this.chooseList.splice(a,1),this.tempChooseList.splice(a,1),this.classifyId.splice(a,1),this.classifyName.splice(a,1));if(this.isSupplider){var i=[];for(var e in this.tempChooseList){var t={firstCategoryId:this.tempChooseList[e].brandId,secCategoryId:this.classifyId[e]};i.push(t)}this.$emit("productcIds",i)}else this.$emit("productcIds",this.classifyId)},brandIsAllCheck:function(){for(var s in this.brandList){var a=0;for(var i in this.brandList[s].classifyList)this.brandList[s].classifyList[i].hasChecked&&a++,a==this.brandList[s].classifyList.length?this.brandList[s].allChecked=!0:this.brandList[s].allChecked=!1}},changeClassifyList:function(s,a,i){for(var e in this.brandList)if(this.brandList[e].id==s)for(var t in this.brandList[e].classifyList)this.brandList[e].classifyList[t].id==a&&(!this.brandList[e].classifyList[t].hasChecked&&"add"==i||this.brandList[e].classifyList[t].hasChecked&&"del"==i)&&(this.brandList[e].classifyList[t].hasChecked=!this.brandList[e].classifyList[t].hasChecked,this.brandList[e].classifyList[t].checked=!1)}}},n={render:function(){var s=this,a=s.$createElement,i=s._self._c||a;return i("div",{staticClass:"choose-box"},[s.isSearch?s._e():i("el-input",{attrs:{placeholder:"输入品牌关键词搜索","suffix-icon":"el-icon-search"},on:{change:s.search},model:{value:s.value,callback:function(a){s.value=a},expression:"value"}}),s._v(" "),i("div",{staticStyle:{"margin-top":"10px"}},[i("div",{staticClass:"check-area"},[i("div",{staticClass:"title"},[s._v("选择一级类目")]),s._v(" "),i("div",[s.brandList?i("ul",{directives:[{name:"loading",rawName:"v-loading",value:s.loading,expression:"loading"}]},s._l(s.brandList,function(a,e){return i("li",{class:s.brandIndex==e?"selected":"",on:{click:function(i){s.chooseBrand(a,e)}}},[s._v(s._s(a.name)+"\n                    ")])})):s._e()])]),s._v(" "),i("div",{staticClass:"check-area"},[i("div",{staticClass:"title"},[s._v("选择二级类目")]),s._v(" "),s.brandList[s.brandIndex].allChecked?i("div",{staticClass:"nodata"},[s._v("\n                暂无数据~\n            ")]):i("div",[s.brandList[s.brandIndex]?i("ul",{directives:[{name:"loading",rawName:"v-loading",value:s.loading,expression:"loading"}]},s._l(s.brandList[s.brandIndex].classifyList,function(a,e){return a.hasChecked?s._e():i("li",{class:a.checked?"selected":"",on:{click:function(i){s.chooseClassify(a,e)}}},[s._v(s._s(a.name)+"\n                    ")])})):s._e()])]),s._v(" "),i("div",{staticClass:"opr-area"},[i("el-button",{attrs:{type:"primary"},on:{click:s.addBrandClassify}},[s._v("添加类目")]),s._v(" "),i("el-button",{on:{click:s.delBrandClassify}},[s._v("删除类目")])],1),s._v(" "),i("div",{staticClass:"check-area"},[i("div",{staticClass:"title"},[s._v("已选择一级-二级")]),s._v(" "),i("div",[i("ul",s._l(s.chooseList,function(a,e){return i("li",{class:a.checked?"selected":"",on:{click:function(i){s.delItem(a,e)}}},[s._v(s._s(a.name)+"\n                    ")])}))])])])],1)},staticRenderFns:[]};var r=i("VU/8")(d,n,!1,function(s){i("WsYk")},"data-v-04a0e688",null);a.a=r.exports},"0JNa":function(s,a){},EztS:function(s,a,i){"use strict";var e=i("UU1J"),t=i("QfvF"),d=(i("rSDL"),{components:{icon:e.a},props:["addOrUp","brandids","detailBrand","secIds"],data:function(){return{brandName:"",allBrandList:[],chooseList:[],brandIds:[],brandNames:[],delIds:[],loading:!1}},watch:{detailBrand:function(s){s&&(this.getHistoryData(),this.getBrandList(this.brandName))},secIds:function(s,a){var i=this;this.getBrandList(),this.allBrandList.forEach(function(s,a){i.$set(i.allBrandList,a,s)})}},activated:function(){this.chooseList=[],this.tempChooseList=[],this.brandName="",this.brandName="",this.brandNames=[],this.brandIds=[],this.delIds=[],"update"!=this.addOrUp||this.getBrandList(this.brandName)},methods:{getHistoryData:function(){for(var s in this.chooseList=[],this.classifyId=[],this.classifyName=[],this.tempChooseList=[],this.detailBrand){var a=this.detailBrand[s].name,i=this.detailBrand[s].brand_id,e={id:i,name:a,checked:!1};this.brandIds.push(i),this.brandNames.push(a),this.chooseList.push(e)}this.$emit("brandids",this.brandIds)},getBrandList:function(s){var a=this;if(a.allBrandList=[],""!=this.secIds){var i={cIds:this.secIds,name:s||""};this.$axios.post(t.c,i).then(function(s){for(var i in s.data.data){var e=s.data.data[i].brand_id;-1==a.brandIds.indexOf(e)&&-1==a.allBrandList.indexOf(e)&&(s.data.data[i].checked=!1,a.allBrandList.push(s.data.data[i]))}})}},chooseBrand:function(s,a){s.checked=!s.checked;var i=s.brand_id,e=s.brand_name;if(s.checked&&-1==this.brandIds.indexOf(i))this.brandIds.push(i),this.brandNames.push(e);else for(var t in this.brandIds)i==this.brandIds[t]&&(this.brandIds.splice(t,1),this.brandNames.splice(t,1))},addBrand:function(){for(var s in this.chooseList=[],this.brandIds){var a={id:this.brandIds[s],name:this.brandNames[s],checked:!1};for(var i in this.chooseList.push(a),this.$set(this.chooseList,s,this.chooseList[s]),this.allBrandList)this.allBrandList[i].brand_id==this.brandIds[s]&&this.allBrandList.splice(i,1)}this.$emit("brandids",this.brandIds)},delItem:function(s,a){if(s.checked=!s.checked,this.chooseList[a].checked)-1==this.delIds.indexOf(s.brand_id)&&this.delIds.push(s.brand_id);else for(var i in this.delIds)s.brand_id==this.delIds[i]&&this.delIds.splice(i,1)},delBrand:function(){for(var s in console.log(this.chooseList),this.delIds)for(var a in this.chooseList)if(this.delIds[s]==this.chooseList[a].brand_id&&this.chooseList[a].checked){var i={brand_id:this.chooseList[a].id,brand_name:this.chooseList[a].name,checked:!1};this.allBrandList.push(i),this.chooseList.splice(a,1),this.brandIds.splice(a,1),this.brandNames.splice(a,1)}this.$emit("brandids",this.brandIds)}}}),n={render:function(){var s=this,a=s.$createElement,i=s._self._c||a;return i("div",{staticClass:"choose-box"},[i("el-input",{attrs:{placeholder:"输入品牌关键词搜索","suffix-icon":"el-icon-search"},on:{change:s.getBrandList},model:{value:s.brandName,callback:function(a){s.brandName=a},expression:"brandName"}}),s._v(" "),i("div",{staticStyle:{"margin-top":"10px"}},[i("div",{staticClass:"check-area"},[i("div",{staticClass:"title"},[s._v("品牌")]),s._v(" "),i("div",[s.allBrandList?i("ul",{directives:[{name:"loading",rawName:"v-loading",value:s.loading,expression:"loading"}]},s._l(s.allBrandList,function(a,e){return i("li",{class:a.checked?"selected":"",on:{click:function(i){s.chooseBrand(a,e)}}},[s._v(s._s(a.brand_name)+"\n                    ")])})):s._e()])]),s._v(" "),i("div",{staticClass:"opr-area"},[i("el-button",{attrs:{type:"primary"},on:{click:s.addBrand}},[s._v("添加品牌")]),s._v(" "),i("el-button",{on:{click:s.delBrand}},[s._v("删除品牌")])],1),s._v(" "),i("div",{staticClass:"check-area"},[i("div",{staticClass:"title"},[s._v("已选择品牌")]),s._v(" "),i("div",[i("ul",s._l(s.chooseList,function(a,e){return i("li",{class:a.checked?"selected":"",on:{click:function(i){s.delItem(a,e)}}},[s._v(s._s(a.name)+"\n                    ")])}))])])])],1)},staticRenderFns:[]};var r=i("VU/8")(d,n,!1,function(s){i("0JNa")},"data-v-4802443c",null);a.a=r.exports},Gmh2:function(s,a){},QCaC:function(s,a,i){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var e=i("mvHQ"),t=i.n(e),d=i("UU1J"),n=i("FMx0"),r=i("/ddM"),o=i("EztS"),l=i("tF3a"),c=i("QfvF"),h=i("rSDL"),f={components:{vBreadcrumb:n.a,icon:d.a,vChoosearea:r.a,region:l.a,vChoosebrand:o.a},data:function(){return{form:{name:"",username:"",mobile:"",itype:"1",country:"1",list:"",brandids:"",address:"",bankName:"",bankOpening:"",bankCard:"",bankUsername:""},first:"",second:"",detailData:[],detailBrand:[],btnLoading:!1,isUp:!1,id:"",address:"",areaDisabled:!0,phone:!0,secIds:""}},activated:function(){this.id=this.$route.query.id||sessionStorage.getItem("supplierDetail"),this.address="",this.getDetail()},methods:{getDetail:function(){var s=this,a=this,i={id:a.id};a.loading=!0,a.$axios.post(c.b,i).then(function(i){if(200==i.data.code)if(a.loading=!1,a.form=i.data.data.map,a.form.bankName=a.form.bank_name,a.form.bankOpening=a.form.bank_opening,a.form.bankCard=a.form.bank_card,a.form.bankUsername=a.form.bank_username,a.form.country=a.form.country.toString(),a.form.itype=a.form.itype.toString(),a.first=a.form.telephone.substring(0,4),a.second=a.form.telephone.substring(4),a.detailData=i.data.data.product,a.detailBrand=i.data.data.brand,2==a.form.country)a.areaDisabled=!1;else{a.areaDisabled=!0;var e=[];e.push(a.form.province_id,s.form.city_id,s.form.area_id),a.address=e}else a.loading=!1,a.$message.warning(i.data.msg)}).catch(function(s){a.loading=!1})},getRegion:function(s){this.address=s,this.form.provinceId=this.address[0],this.form.cityId=this.address[1],this.form.areaId=this.address[2],console.log(this.address)},supplierArea:function(){this.areaDisabled=1==this.form.country},productcIds:function(s){var a=[];s.forEach(function(s){a.push(s.secCategoryId)}),this.secIds=a.join(","),this.form.list=t()(s)},brandids:function(s){this.form.brandids=s.join(",")},checkPhone:function(){if(!/^1[3-8]\d{9}$/.test(this.form.mobile))return this.$message.warning("请输入正确的手机号格式!"),this.phone=!1,!1;this.phone=!0},submitForm:function(s){var a=this;if(a[s].name)if(a[s].username)if(a[s].mobile)if(1!=a.form.country||(this.form.provinceId=this.address[0],this.form.cityId=this.address[1],this.form.areaId=this.address[2],a.form.provinceId&&a.form.cityId&&a.form.areaId))if(a[s].address)if(2!=!a.form.list.length)if(a.form.brandids)if(a.form.bankName)if(a.form.bankOpening)if(a.form.bankCard){if(/^([1-9]{1})(\d{14}|\d{18})$/.test(a.form.bankCard))if(a.form.bankUsername){if(0==a.phone)return!1;a.btnLoading=!0;var i=this[s];i.telephone=a.first+a.second,i.url=h.updateSupplier,i.id=a.id,this.$axios.post(c.e,i).then(function(s){200==s.data.code?(a.$message.success(s.data.msg),setTimeout(function(){a.$router.push("/supplierManage"),a.btnLoading=!1},1e3)):(a.ajax=!1,a.$message.warning(s.data.msg),a.btnLoading=!1)}).catch(function(s){console.log(s),a.btnLoading=!1,a.ajax=!1})}else a.$message.warning("请输入持卡人姓名!");else a.$message.warning("请输入合法的银行卡号!")}else a.$message.warning("请输入银行卡号!");else a.$message.warning("请输入请输入开户支行!");else a.$message.warning("请输入银行名称!");else a.$message.warning("请选择供应产品品牌!");else a.$message.warning("请选择供应产品品类!");else a.$message.warning("请输入详细地址!");else a.$message.warning("请输入省市区!");else a.$message.warning("请输入联系方式!");else a.$message.warning("请输入供应商姓名!");else a.$message.warning("请输入供货商名称!")},cancel:function(){this.$router.push("/supplierManage")}}},m={render:function(){var s=this,a=s.$createElement,i=s._self._c||a;return i("div",[i("v-breadcrumb",{attrs:{nav:["经销商会员管理","供应商管理","编辑供应商"]}}),s._v(" "),i("div",{staticClass:"container"},[i("div",{staticClass:"supplier-box"},[i("el-form",{ref:"form",attrs:{model:s.form}},[i("el-form-item",{attrs:{prop:"name",label:"供应商名称"}},[i("el-input",{attrs:{placeholder:"请输入供应商名称"},model:{value:s.form.name,callback:function(a){s.$set(s.form,"name",a)},expression:"form.name"}})],1),s._v(" "),i("el-form-item",{attrs:{prop:"name",label:"供应商类型",placeholder:"请选择"}},[i("el-select",{model:{value:s.form.itype,callback:function(a){s.$set(s.form,"itype",a)},expression:"form.itype"}},[i("el-option",{attrs:{label:"产品供应商",value:"1"}},[s._v("产品供应商")]),s._v(" "),i("el-option",{attrs:{label:"服务供应商",value:"2"}},[s._v("服务供应商")])],1)],1),s._v(" "),i("el-form-item",{attrs:{prop:"name",label:"供应商姓名"}},[i("el-input",{attrs:{placeholder:"请输入供应商姓名"},model:{value:s.form.username,callback:function(a){s.$set(s.form,"username",a)},expression:"form.username"}})],1),s._v(" "),i("el-form-item",{staticClass:"phone-area",attrs:{prop:"name",label:"联系方式"}},[i("el-input",{staticClass:"small-inp",model:{value:s.first,callback:function(a){s.first=a},expression:"first"}}),s._v(" "),i("el-input",{staticClass:"mid-inp",model:{value:s.second,callback:function(a){s.second=a},expression:"second"}}),s._v(" "),i("div",{staticClass:"intent"},[i("el-input",{on:{blur:s.checkPhone},model:{value:s.form.mobile,callback:function(a){s.$set(s.form,"mobile",a)},expression:"form.mobile"}})],1)],1),s._v(" "),i("el-form-item",{staticClass:"address-item",attrs:{prop:"country",label:"供应商地址"}},[i("el-select",{staticClass:"small-inp",on:{change:s.supplierArea},model:{value:s.form.country,callback:function(a){s.$set(s.form,"country",a)},expression:"form.country"}},[i("el-option",{attrs:{label:"中国",value:"1"}},[s._v("中国")]),s._v(" "),i("el-option",{attrs:{label:"海外",value:"2"}},[s._v("海外")])],1),s._v(" "),i("div",{staticClass:"address-area"},[i("region",{attrs:{regionMsg:s.address,isDisabled:!s.areaDisabled},on:{regionMsg:s.getRegion}})],1),s._v(" "),i("div",{staticClass:"intent"},[i("el-input",{attrs:{placeholder:"请输入详细地址"},model:{value:s.form.address,callback:function(a){s.$set(s.form,"address",a)},expression:"form.address"}})],1)],1),s._v(" "),i("el-form-item",{staticClass:"classify-area",attrs:{prop:"productcIds",label:"供应产品品类品牌"}},[i("v-choosearea",{attrs:{detailData:s.detailData,addOrUp:s.isUp?"update":"",isSearch:!0,isSupplider:!0},on:{productcIds:s.productcIds},model:{value:s.form.list,callback:function(a){s.$set(s.form,"list",a)},expression:"form.list"}}),s._v(" "),i("div",{staticClass:"clearfix"}),s._v(" "),i("div",{staticClass:"intent"},[i("v-choosebrand",{attrs:{secIds:s.secIds,detailBrand:s.detailBrand,addOrUp:"update"},on:{brandids:s.brandids},model:{value:s.form.brandids,callback:function(a){s.$set(s.form,"brandids",a)},expression:"form.brandids"}})],1)],1),s._v(" "),i("el-form-item",{attrs:{label:"供应商账号"}},[i("el-input",{attrs:{placeholder:"请输入银行名称"},model:{value:s.form.bankName,callback:function(a){s.$set(s.form,"bankName",a)},expression:"form.bankName"}}),s._v(" "),i("el-input",{attrs:{placeholder:"请输入开户支行"},model:{value:s.form.bankOpening,callback:function(a){s.$set(s.form,"bankOpening",a)},expression:"form.bankOpening"}})],1),s._v(" "),i("el-form-item",{attrs:{prop:"bankCard",label:"卡号"}},[i("el-input",{attrs:{placeholder:"请输入银行卡号"},model:{value:s.form.bankCard,callback:function(a){s.$set(s.form,"bankCard",a)},expression:"form.bankCard"}})],1),s._v(" "),i("el-form-item",{attrs:{prop:"bankUsername",label:"持卡人"}},[i("el-input",{attrs:{placeholder:"请输入持卡人姓名"},model:{value:s.form.bankUsername,callback:function(a){s.$set(s.form,"bankUsername",a)},expression:"form.bankUsername"}})],1),s._v(" "),i("div",{staticClass:"submit-btn"},[i("el-button",{attrs:{type:"primary",loading:s.btnLoading},on:{click:function(a){s.submitForm("form")}}},[s._v("确认保存")]),s._v(" "),i("el-button",{on:{click:s.cancel}},[s._v("取消")])],1)],1)],1)])],1)},staticRenderFns:[]};var u=i("VU/8")(f,m,!1,function(s){i("Gmh2")},null,null);a.default=u.exports},WsYk:function(s,a){}});