webpackJsonp([28],{HDUj:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("FMx0"),s=a("P9l9"),o=a("GVVA"),n={props:["name"],mixins:[a("xnHa").b],data:function(){return{tableData:[],height:"100vh",tableLoading:!1,status:""}},activated:function(){this.height=window.screen.availHeight-400},methods:{getList:function(){var e=this,t={type:this.status,page:this.page.currentPage};this.tableLoading=!0,o.a.queryVersionRecordPageList(t).then(function(t){e.tableLoading=!1,e.tableData=[],e.tableData=t.data.data,e.page.totalPage=t.data.totalNum}).catch(function(t){e.tableLoading=!1,console.log(t)})},addVersion:function(){this.$emit("addVersion")},showDeleteToast:function(e){this.$emit("showDeleteToast",e)},editVersion:function(e){this.$emit("addVersion",e)}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"version-iter"},[a("el-button",{attrs:{type:"primary"},on:{click:e.addVersion}},[e._v("新建版本信息")]),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticStyle:{"margin-top":"20px"},attrs:{data:e.tableData,border:"",height:e.height}},[a("el-table-column",{attrs:{prop:"id",label:"编号",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"version",label:"版本号",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"上传时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s(e._f("formatDate")(t.row.createTime))+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"coerce",label:"是否强制更新",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s(1==t.row.coerce?"是":"不是")+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"description",label:"备注",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary"},on:{click:function(a){e.editVersion(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{type:"danger"},on:{click:function(a){e.showDeleteToast(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{background:"","current-page":e.page.currentPage,layout:"total, prev, pager, next, jumper",total:e.page.totalPage},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},staticRenderFns:[]};var l=a("VU/8")(n,r,!1,function(e){a("KbYr")},"data-v-7fe5680a",null).exports,c=a("EkIv"),d={components:{vBreadcrumb:i.a,deleteToast:c.a,vVersionTemp:l},data:function(){return{nav:["权限设置","版本迭代管理"],activeName:"IOS",isShowAddQues:!1,uploadLoading:!1,questionType:"",addQuesTypeBtn:!1,isShowDelToast:!1,uploadUrl:"",delId:"",delUrl:"",delUri:"",form:{},title:"新增版本",type:"",url:"",btnLoading:!1}},computed:{upUrl:function(){return s.addFile}},activated:function(){this.$refs[this.activeName].getList(this.$refs[this.activeName].page.currentPage,this.$refs[this.activeName].status="IOS"===this.activeName?2:1)},methods:{beforeUpload:function(e){this.uploadLoading=!0},uploadSuccess:function(e){this.form.dowloadUrl=e.data,this.uploadLoading=!1},showDeleteToast:function(e){this.delId=e.id,this.delUrl="deleteVersionRecord",this.isShowDelToast=!this.isShowDelToast},deleteToast:function(e){this.isShowDelToast=e,this.$refs[this.activeName].getList(this.$refs[this.activeName].page.currentPage,this.$refs[this.activeName].status="IOS"===this.activeName?2:1)},addVersion:function(e){e?(this.title="编辑版本信息",this.url="updateVersionRecord",this.isShowAddQues=!this.isShowAddQues,this.form=e):(this.form.type="IOS"===this.activeName?2:1,this.url="addVersionRecord",this.isShowAddQues=!this.isShowAddQues)},onSubmit:function(){var e=this;""!==this.form.version&&""!==this.form.forceUpdate&&""!==this.form.description?(this.btnLoading=!0,o.a[this.url](this.form).then(function(t){e.$refs[e.activeName].getList(e.$refs[e.activeName].page.currentPage,e.$refs[e.activeName].status="IOS"===e.activeName?2:1),e.$message.success(t.msg),e.isShowAddQues=!1,e.btnLoading=!1}).catch(function(t){console.log(t),e.btnLoading=!1})):this.$message.warning("请填写完整信息")},resetForm:function(){this.form={}},changeTab:function(e){"IOS"==e.name?this.$refs[this.activeName].getList(this.$refs[this.activeName].page.currentPage,this.$refs[this.activeName].status=2):this.$refs[this.activeName].getList(this.$refs[this.activeName].page.currentPage,this.$refs[this.activeName].status=1)}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"versionpage"},[a("v-breadcrumb",{attrs:{nav:e.nav}}),e._v(" "),a("el-card",{attrs:{"body-style":{padding:"30px 60px"}}},[a("el-tabs",{on:{"tab-click":e.changeTab},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"IOS",name:"IOS"}},[a("v-version-temp",{ref:"IOS",attrs:{name:e.activeName},on:{showDeleteToast:e.showDeleteToast,addVersion:e.addVersion}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"Android",name:"Android"}},[a("v-version-temp",{ref:"Android",attrs:{name:e.activeName},on:{showDeleteToast:e.showDeleteToast,addVersion:e.addVersion}})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.isShowAddQues,width:"30%"},on:{"update:visible":function(t){e.isShowAddQues=t},close:e.resetForm}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"版本号"}},[a("el-input",{model:{value:e.form.version,callback:function(t){e.$set(e.form,"version",t)},expression:"form.version"}})],1),e._v(" "),"IOS"!=e.activeName?a("el-form-item",{attrs:{label:"上传APK"}},[a("el-input",{model:{value:e.form.url,callback:function(t){e.$set(e.form,"url",t)},expression:"form.url"}}),e._v(" "),a("el-upload",{attrs:{action:e.upUrl,"show-file-list":!1,"before-upload":e.beforeUpload,"on-success":e.uploadSuccess}},[a("el-button",{attrs:{loading:e.uploadLoading,type:"primary"}},[e._v("上传apk")])],1)],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"是否强制更新"}},[a("el-radio-group",{model:{value:e.form.forceUpdate,callback:function(t){e.$set(e.form,"forceUpdate",t)},expression:"form.forceUpdate"}},[a("el-radio",{attrs:{label:1,value:"1"}},[e._v("是")]),e._v(" "),a("el-radio",{attrs:{label:0,value:"0"}},[e._v("否")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"备注说明"}},[a("el-input",{attrs:{maxlength:180,type:"textarea"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),e._v(" "),a("el-form-item",[a("div",{staticClass:"btnDiv"},[a("el-button",{attrs:{type:"primary",loading:e.btnLoading},on:{click:e.onSubmit}},[e._v("确认保存")]),e._v(" "),a("el-button",{on:{click:function(t){e.resetForm("form")}}},[e._v("重置")])],1)])],1)],1),e._v(" "),e.isShowDelToast?a("delete-toast",{attrs:{id:e.delId,url:e.delUrl,uri:e.delUri},on:{msg:e.deleteToast}}):e._e()],1)],1)},staticRenderFns:[]};var m=a("VU/8")(d,u,!1,function(e){a("mzdU")},"data-v-10a6374e",null);t.default=m.exports},KbYr:function(e,t){},mzdU:function(e,t){}});