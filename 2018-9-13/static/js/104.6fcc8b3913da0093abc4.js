webpackJsonp([104],{dGHX:function(t,e){},t1aT:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("mvHQ"),o=a.n(n),r=a("FMx0"),s=a("go8C"),c=a("5fic"),i=a("V3Ru"),l=(a("0xDb"),{components:{vBreadcrumb:r.a,vRemark:s.a},data:function(){return{nav:["运营管理","营销工具管理","优惠套餐","添加库存"],contents:["当出现相同产品时，填写规格的发放数量之和请勿大于该规格现有库存"],btnLoading:!1,packageCode:"",id:"",inventoryData:[],spanData:[]}},activated:function(){this.packageCode=this.$route.query.packageCode||sessionStorage.getItem("packageCode"),this.id=this.$route.query.id||sessionStorage.getItem("id"),this.getPackageProInfo(),this.spanData=[]},methods:{getPackageProInfo:function(){var t=this;this.$axios.post(c.y,{packageCode:this.packageCode}).then(function(e){t.inventoryData=[];var a=0,n=t;e.data.data.forEach(function(e,o){var r=e.specValues.split(","),s=e.productPriceId.split(","),c=e.totalStock.split(","),i=e.packageSpecValueId.split(","),l=e.leftStock.split(","),u=e.surplusStock.split(","),p=e.totalStock.split(",");for(var d in n.spanData.push({startIndex:a,num:r.length}),a+=r.length,r){var v={packageCodeProductId:e.id,productPriceId:s[d],specValues:r[d],stock:c[d],packageSpecValueId:i[d],totalStock:p[d],leftStock:l[d],surplusStock:u[d],productName:e.productName,spec:r[d],productCode:e.productCode,index:o+1};t.inventoryData.push(v)}})})},provideNum:function(t){return/^\d+$/.test(t.number)?t.number>Number(t.totalStock)?(this.$message.warning("新增库存数不能大于现有库存！"),void(t.number="")):void 0:(this.$message.warning("请输入合法数据！"),void(t.number=""))},submitForm:function(){var t=this,e=[];this.inventoryData.forEach(function(t,a){var n={id:t.packageSpecValueId,productPriceId:t.productPriceId,stock:t.number?t.number:0};e.push(n)});var a={};a.id=this.id,a.stockStr=o()(e),a.url=i.updatePackageSpecValueStock,this.btnLoading=!0,this.$axios.post(c.H,a).then(function(e){t.$message.success(e.data.msg),t.$router.push("/packageList"),t.btnLoading=!1}).catch(function(e){t.btnLoading=!1})},mergeRow:function(t){t.row,t.column;var e=t.rowIndex,a=t.columnIndex;if(0===a||1===a){for(var n=0;n<this.spanData.length;n++)if(e===this.spanData[n].startIndex)return{rowspan:this.spanData[n].num,colspan:1};return{rowspan:0,colspan:0}}},backToList:function(){this.$router.push("/packageList")}}}),u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"price-inventory"},[a("v-breadcrumb",{attrs:{nav:t.nav}}),t._v(" "),a("el-card",{attrs:{"body-style":{padding:"20px 45px"}}},[a("div",{staticClass:"pro-title"},[t._v("发放库存设置")]),t._v(" "),a("v-remark",{attrs:{contents:t.contents}}),t._v(" "),a("el-table",{staticClass:"inventory-table",attrs:{data:t.inventoryData,border:"","span-method":t.mergeRow}},[a("el-table-column",{attrs:{prop:"index",label:"产品序号",align:"center",width:"80"}}),t._v(" "),a("el-table-column",{attrs:{prop:"productName",label:"产品名称",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"spec",label:"产品规格",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"totalStock",label:"现有库存",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"leftStock",label:"发放数量",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"surplusStock",label:"套餐现有库存",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"新增库存",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{on:{change:function(a){t.provideNum(e.row)}},model:{value:e.row.number,callback:function(a){t.$set(e.row,"number",a)},expression:"scope.row.number"}})]}}])})],1),t._v(" "),a("div",{staticClass:"btn-group"},[a("el-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[t._v("确认")]),t._v(" "),a("el-button",{on:{click:t.backToList}},[t._v("取消")])],1)],1)],1)},staticRenderFns:[]};var p=a("VU/8")(l,u,!1,function(t){a("dGHX")},"data-v-56df97ba",null);e.default=p.exports}});