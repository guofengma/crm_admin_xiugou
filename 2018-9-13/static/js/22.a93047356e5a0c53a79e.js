webpackJsonp([22],{BBuG:function(t,e,r){"use strict";var o=r("5fic"),s=(r("V3Ru"),r("0xDb"),{components:{},props:["productId","activityType","searchProductId","searchProductName"],data:function(){return{keyWords:"",keyWordsID:"",stock:"",flagStatus:"",status:"",productNum:"",tableData:[],checkList:[],selectedPro:[],chooseId:"",productDetail:"",showResult:!1,noResult:!1,resultTip:"",name:"",prodCode:""}},created:function(){this.tableData=[],this.keyWords="",this.chooseId=this.productId,this.searchProductId&&(this.keyWordsID=this.searchProductId,this.keyWords=this.searchProductName,this.getSpecList())},methods:{closeMask:function(t){if(t){if(!this.chooseId)return void this.$message.warning("请选择商品!");this.$emit("getProductInf",this.productDetail)}else this.$emit("getProductInf",!1)},getSpecList:function(){var t=this;""!=this.keyWordsID?(this.showResult=!0,0==this.productNum||0==this.flagStatus||5==this.status?(this.noResult=!0,0==this.flagStatus?this.resultTip="已参与同类活动":5==this.status?this.resultTip="已下架":0==this.productNum&&(this.resultTip="该商品无库存")):(this.noResult=!1,this.$axios.post(o.A,{productId:this.keyWordsID}).then(function(e){t.tableData=[],t.tableData=e.data.data,t.showResult=!0}))):this.$message.success("暂无数据")},querySearchAsync:function(t,e){""!=t&&(this.keyWordsID="",this.$axios.post(o.z,{condition:t,activityType:this.activityType}).then(function(t){var r=[];t.data.data.forEach(function(t,e){var o={};o.value=t.name+" 产品ID："+t.prodCode,o.id=t.id,o.productNum=t.productNum,o.flagStatus=t.flagStatus,o.name=t.name,o.status=t.status,o.prodCode=t.prodCode,r.push(o)}),e(r)}))},handleSelect:function(t){this.keyWordsID=t.id,this.productNum=t.productNum,this.flagStatus=t.flagStatus,this.status=t.status,this.name=t.name,this.prodCode=t.prodCode},selectPro:function(t){this.chooseId=t.id,t.specImg||(t.specImg=t.imgUrl),this.productDetail=t,this.productDetail.searchProductId=this.keyWordsID}}}),i={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"choose-product-mask"},[r("div",{staticClass:"choose-product"},[r("el-card",{attrs:{"body-style":{padding:"50px"}}},[r("span",{staticClass:"title"},[t._v("商品名称/ID")]),t._v(" "),r("el-autocomplete",{staticStyle:{width:"230px"},attrs:{"fetch-suggestions":t.querySearchAsync,placeholder:"请输入产品名称模糊搜索"},on:{select:t.handleSelect},model:{value:t.keyWords,callback:function(e){t.keyWords=e},expression:"keyWords"}}),t._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:t.getSpecList}},[t._v("搜索")]),t._v(" "),t.showResult?r("div",[t.noResult?r("div",{staticClass:"nodata"},[r("table",[r("tr",[r("td",{staticClass:"product-inf"},[t._v(t._s(t.name)+" "+t._s(t.prodCode))]),t._v(" "),r("td",{staticClass:"color-red no-stock"},[t._v(t._s(t.resultTip))])])])]):r("el-table",{staticStyle:{"margin-top":"10px"},attrs:{data:t.tableData,border:""}},[r("el-table-column",{attrs:{prop:"spec",label:"规格",align:"center"}}),t._v(" "),r("el-table-column",{attrs:{label:"选择",align:"center",width:"150px"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-radio",{attrs:{disabled:0==e.row.stock,label:e.row.id,value:e.id},on:{change:function(r){t.selectPro(e.row)}},model:{value:t.chooseId,callback:function(e){t.chooseId=e},expression:"chooseId"}},[t._v("选择"),0==e.row.stock?r("span",{staticClass:"color-red"},[t._v("(无库存)")]):t._e()])]}}])})],1)],1):r("div",{staticClass:"nodata"},[r("table",{staticStyle:{"text-align":"center"}},[r("tr",[r("td",[t._v("请输入产品名称模糊搜索~")])])])]),t._v(" "),r("div",{staticStyle:{margin:"20px 0 30px",float:"right"}},[r("el-button",{attrs:{type:"primary"},on:{click:function(e){t.closeMask(!0)}}},[t._v("确认")]),t._v(" "),r("el-button",{on:{click:function(e){t.closeMask(!1)}}},[t._v("取消")])],1)],1)],1)])},staticRenderFns:[]};var a=r("VU/8")(s,i,!1,function(t){r("wtDC")},"data-v-dfeb225c",null);e.a=a.exports},FT5b:function(t,e){},tF2C:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=r("FMx0"),s=r("BBuG"),i=r("UU1J"),a=r("5fic"),c=r("V3Ru"),l=(r("0xDb"),r("PJh5")),n=r.n(l),u={components:{vBreadcrumb:o.a,icon:i.a,vChooseproduct:s.a},data:function(){var t=this;return{nav:["运营管理","营销工具管理","秒杀","新建秒杀"],rules:{orderCloseTime:[{validator:function(t,e,r){if(!e)return r(new Error("参数不能为空!"));/^[1-9]*[1-9][0-9]*$/.test(e)?r():r(new Error("请输入正整数"))},trigger:"blur"}],seckillPrice:[{validator:function(t,e,r){if(!e)return r(new Error("参数不能为空!"));/^[0-9]+([.]{1}[0-9]{1,2})?$/.test(e)?r():r(new Error("请输入两位小数"))},trigger:"blur"}],totalNumber:[{validator:function(e,r,o){if(!r)return o(new Error("参数不能为空!"));r>t.productDetail.stock?o(new Error("发放数量不能大于商品库存!")):o()},trigger:"blur"}],limitNumber:[{validator:function(t,e,r){if(""===e)return r(new Error("参数不能为空!"));/^\d+$/.test(e)?r():r(new Error("请输入非负整数"))},trigger:"blur"}]},form:{activityTime:"",seckillPrice:"",orderCloseTime:"",totalNumber:"",limitNumber:"0"},showMask:!1,productDetail:{},btnLoading:!1}},activated:function(){this.productDetail={},this.form={},this.form.limitNumber=0},methods:{chooseProduct:function(){this.showMask=!0},productInf:function(t){this.showMask=!1,0!=t&&(this.productDetail=t)},submitForm:function(){var t=this;this.$refs.form.validate(function(e){if(!e)return console.log("error submit!!"),t.btnLoading=!1,!1;if(t.productDetail.id)if(t.form.activityTime){var r={};r.beginTime=n()(t.form.activityTime[0]).format("YYYY-MM-DD HH:mm:ss"),r.endTime=n()(t.form.activityTime[1]).format("YYYY-MM-DD HH:mm:ss"),r.orderCloseTime=t.form.orderCloseTime,r.productCode=t.productDetail.productCode,r.productId=t.productDetail.productId,r.productImg=t.productDetail.specImg,r.productName=t.productDetail.productName,r.productPrice=t.productDetail.originalPrice,r.productPriceId=t.productDetail.id,r.productSpec=t.productDetail.spec,r.seckillPrice=t.form.seckillPrice,r.totalNumber=t.form.totalNumber,r.limitNumber=t.form.limitNumber,r.url=c.addOperatorSeckill,t.btnLoading=!0,t.$axios.post(a.c,r).then(function(e){t.$message.success(e.data.msg),t.$router.push("/secKill"),t.btnLoading=!1}).catch(function(e){t.btnLoading=!1})}else t.$message.warning("请选择活动时间！");else t.$message.warning("请选择商品！")})},cancel:function(){this.$router.push("/secKill")}}},d={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"add-secKill"},[r("v-breadcrumb",{attrs:{nav:t.nav}}),t._v(" "),r("el-card",{attrs:{"body-style":{padding:"20px 45px",color:"#666"}}},[r("div",{staticClass:"pro-title"},[t._v("新建秒杀")]),t._v(" "),r("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"选择商品"}},[r("el-button",{attrs:{type:"primary"},on:{click:t.chooseProduct}},[t._v("+添加商品")])],1),t._v(" "),r("el-form-item",{attrs:{label:"商品名称"}},[t.productDetail.productName?r("span",[t._v(t._s(t.productDetail.productName))]):r("span",[t._v("--")])]),t._v(" "),r("el-form-item",{attrs:{label:"商品规格"}},[t.productDetail.spec?r("span",[t._v(t._s(t.productDetail.spec))]):r("span",[t._v("--")])]),t._v(" "),r("el-form-item",{attrs:{label:"商品原价"}},[t.productDetail.originalPrice?r("span",{staticClass:"color-red"},[t._v(t._s(t.productDetail.originalPrice))]):r("span",[t._v("--")])]),t._v(" "),r("el-form-item",{attrs:{label:"商品库存"}},[t.productDetail.stock?r("span",[t._v(t._s(t.productDetail.stock))]):r("span",[t._v("--")])]),t._v(" "),r("el-form-item",{staticStyle:{"margin-top":"30px"},attrs:{label:"秒杀价",prop:"seckillPrice"}},[t._v("\n                ￥\n                "),r("el-input",{model:{value:t.form.seckillPrice,callback:function(e){t.$set(t.form,"seckillPrice",e)},expression:"form.seckillPrice"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"活动时间",prop:"activityTime"}},[r("el-date-picker",{attrs:{type:"datetimerange","start-placeholder":"开始时间","end-placeholder":"结束时间"},model:{value:t.form.activityTime,callback:function(e){t.$set(t.form,"activityTime",e)},expression:"form.activityTime"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"设置关闭订单",prop:"orderCloseTime"}},[r("el-input",{staticClass:"small",model:{value:t.form.orderCloseTime,callback:function(e){t.$set(t.form,"orderCloseTime",e)},expression:"form.orderCloseTime"}}),t._v(" "),r("span",[t._v("分钟未付款自动关闭订单")])],1),t._v(" "),r("el-form-item",{attrs:{label:"商品发放数量",prop:"totalNumber"}},[r("el-input",{staticClass:"small",model:{value:t.form.totalNumber,callback:function(e){t.$set(t.form,"totalNumber",e)},expression:"form.totalNumber"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"每人限购",prop:"limitNumber"}},[r("el-input",{staticClass:"small",model:{value:t.form.limitNumber,callback:function(e){t.$set(t.form,"limitNumber",e)},expression:"form.limitNumber"}}),t._v(" "),r("span",{staticClass:"tip"},[t._v("(同一用户ID视为同一人)")])],1),t._v(" "),r("el-button",{attrs:{type:"primary",loading:t.btnLoading},on:{click:t.submitForm}},[t._v("确认保存")]),t._v(" "),r("el-button",{on:{click:t.cancel}},[t._v("取消")])],1)],1),t._v(" "),t.showMask?r("v-chooseproduct",{attrs:{productId:t.productDetail.id,searchProductId:t.productDetail.searchProductId,searchProductName:t.productDetail.productName,activityType:1},on:{getProductInf:t.productInf}}):t._e()],1)},staticRenderFns:[]};var m=r("VU/8")(u,d,!1,function(t){r("FT5b")},"data-v-6e373832",null);e.default=m.exports},wtDC:function(t,e){}});