webpackJsonp([46],{QBHJ:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("Xxa5"),r=a.n(i),l=a("exGp"),n=a.n(l),o=a("FMx0"),s=a("EkIv"),d=(a("0xDb"),a("PJh5")),m=a.n(d),c="/admin/topic/getNameById",p=a("xnHa"),u={components:{vBreadcrumb:o.a,deletetoast:s.a},mixins:[p.b,p.c],data:function(){return{nav:["运营管理","广告位管理","APP首页banner广告位"],isAddBanner:!1,diaTitle:"添加Banner图片",formLabelWidth:"130px",tableData:[],addMask:!1,editMask:!1,btnLoading:!1,form:{img:"",imgUrl:"",linkType:"",linkTypeValue:"",remark:"",sortRank:"",date:[]},addForm:{img:"",imgUrl:"",linkType:"",linkTypeValue:"",remark:"",sortRank:"",date:[]},linkTypeList:[],row:"",id:"",itemId:"",delUrl:"",delUri:"",delId:"",isShowDel:!1,value:"",itype:"",showDetail:!1,productName:"",proId:"",type:1,pageType:"",addTitle:"添加banner图片",editTitle:"编辑banner图片"}},activated:function(){this.pageType=this.$route.query.appBannerAdvId||sessionStorage.getItem("appBannerAdvId"),5==this.pageType?(this.addTitle="添加首页长条广告位",this.editTitle="编辑首页长条广告位"):(this.addTitle="添加banner图片",this.editTitle="编辑banner图片"),this.getList(),this.showNav(this.pageType)},methods:{changeTime:function(){this.$mount()},showNav:function(e){var t="";switch(e){case 1:t=["运营管理","广告位管理","APP首页banner广告位"];break;case 2:t=["运营管理","广告位管理","拼店首页banner推荐位"];break;case 3:t=["运营管理","广告位管理","登录首页头图展示图"];break;case 4:t=["运营管理","广告位管理","发现模块banner推荐图"];break;case 5:t=["运营管理","广告位管理","首页长条广告位管理"]}this.nav=t},getList:function(){var e=this,t={page:this.page.currentPage,pageType:this.pageType,type:5==this.pageType?"2":""};this.$axios.post("/admin/ad/queryAdList",t).then(function(t){200==t.data.code?(e.tableData=[],e.tableData=t.data.data.data,e.page.totalPage=t.data.data.resultCount):e.$message.warning(t.data.msg)}).catch(function(e){console.log(e)})},addBanImg:function(){var e=this;return n()(r.a.mark(function t(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.addMask=!0,e.addForm.imgUrl="",e.addForm.img="",e.addForm.linkType="",e.addForm.linkTypeValue="",e.productName="",e.addForm.remark="",e.addForm.sortRank="",e.addForm.date="",e.itype="add",e.proId=!0,t.next=13,e.queryDictonary(9);case 13:e.linkTypeList=e.tmpAxiosData;case 14:case"end":return t.stop()}},t,e)}))()},editBanImg:function(e){var t=this;return n()(r.a.mark(function a(){return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t.editMask=!0,t.itemId=e,t.getDetail(e),t.itype="edit",t.productName="",t.proId=!0,a.next=8,t.queryDictonary(9);case 8:t.linkTypeList=t.tmpAxiosData;case 9:case"end":return a.stop()}},a,t)}))()},addOrEdit:function(e){var t=this,a="",i={};if(i.imgUrl=this[e].imgUrl,i.linkType=this[e].linkType,i.linkTypeValue=this[e].linkTypeValue,i.pageType=this.pageType,i.remark=this[e].remark,i.sortRank=this[e].sortRank,this[e].date&&5!=this.pageType&&(i.showBegintime=m()(this[e].date[0]).format("YYYY-MM-DD HH:mm:ss"),i.showEndtime=m()(this[e].date[1]).format("YYYY-MM-DD HH:mm:ss")),i.imgUrl)if(i.linkType)if(i.linkTypeValue)if(i.sortRank){if(!this.proId)return!1;"add"==this.itype?(a="/admin/ad/addAd",i.url="/admin/ad/addAd"):(a="/admin/ad/updateAd",i.id=this.itemId,i.url="/admin/ad/updateAd"),i.type=5==this.pageType?"2":this.type,i.pageType=this.pageType,this.btnLoading=!0,this.$axios.post(a,i).then(function(e){200==e.data.code?(t.$message.success(e.data.msg),t.btnLoading=!1,t.addMask=!1,t.editMask=!1,t.btnLoading=!1,t.getList()):(t.btnLoading=!1,t.$message.warning(e.data.msg),t.getList())}).catch(function(e){t.btnLoading=!1,console.log(e)})}else this.$message.warning("请输入排序!");else this.$message.warning("请输入ID!");else this.$message.warning("请选择类型!");else this.$message.warning("请上传图片!")},handleAvatarSuccess:function(e){"add"==this.itype?(this.addForm.img=e.data.imageUrl,this.addForm.imgUrl=e.data.imageUrl):(this.form.img=e.data.imageUrl,this.form.imgUrl=e.data.imageUrl)},cancel:function(){this.addMask=!1,this.editMask=!1,this.getList()},del:function(e){this.delUrl="/admin/ad/deleteAd",this.delUri="/admin/ad/deleteAd",this.delId=e,this.isShowDel=!0},deleteToast:function(e){this.isShowDel=e,this.getList()},searchProduct:function(){var e=this,t={},a="";this.productName="","add"==this.itype?1==this.addForm.linkType?(t.prodCode=this.addForm.linkTypeValue,a="/admin/product/findProductNameByProdCode"):(t.id=Number(this.addForm.linkTypeValue),a=c):1==this.form.linkType?(t.prodCode=this.form.linkTypeValue,a="/admin/product/findProductNameByProdCode"):(t.id=Number(this.form.linkTypeValue),a=c),this.$axios.post(a,t).then(function(t){200==t.data.code?(e.showDetail=!0,e.productName=t.data.data,e.proId=!0):(e.proId=!1,e.$message.warning(t.data.msg))}).catch(function(t){console.log(t),e.proId=!1})},getDetail:function(e){var t=this,a={id:e};this.$axios.post("/admin/ad/findAdById",a).then(function(e){200==e.data.code?(t.form=e.data.data,t.form.img=t.form.imgUrl,t.form.linkType=t.form.linkType.toString(),t.form.date=[],t.form.date[0]=t.form.showBegintime,t.form.date[1]=t.form.showEndtime):t.$message.warning(e.data.msg)})}}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-banner-adv"},[a("v-breadcrumb",{attrs:{nav:e.nav}}),e._v(" "),a("el-card",{attrs:{"body-style":{padding:"20px 40px"}}},[5!=e.pageType?a("el-button",{staticStyle:{"margin-bottom":"20px"},attrs:{type:"primary"},on:{click:e.addBanImg}},[e._v("添加banner图片\n        ")]):a("el-button",{staticStyle:{"margin-bottom":"20px"},attrs:{type:"primary"},on:{click:e.addBanImg}},[e._v("添加首页长条广告位")]),e._v(" "),a("el-table",{attrs:{border:"",data:e.tableData}},[a("el-table-column",{attrs:{type:"index",label:"编号",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"图片",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("img",{staticClass:"img",attrs:{src:e.row.img_url}})]}}])}),e._v(" "),5!=e.pageType?a("el-table-column",{attrs:{prop:"link_type",label:"链接",align:"center"}}):a("el-table-column",{attrs:{prop:"id",label:"ID",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"remark",label:"备注",align:"center"}}),e._v(" "),5!=e.pageType?a("el-table-column",{attrs:{prop:"show_begintime",label:"投放时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(e._f("formatDate")(t.row.show_begintime))+"~"+e._s(e._f("formatDate")(t.row.show_endtime))+"\n                ")]}}])}):e._e(),e._v(" "),a("el-table-column",{attrs:{prop:"sort_rank",label:"排序",align:"center",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary"},on:{click:function(a){e.editBanImg(t.row.id)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{type:"warning"},on:{click:function(a){e.del(t.row.id)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{background:"","current-page":e.page.currentPage,layout:"total, prev, pager, next, jumper",total:e.page.totalPage},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.addTitle,visible:e.addMask},on:{"update:visible":function(t){e.addMask=t}}},[a("el-form",{attrs:{"label-width":"100px"},model:{value:e.addForm,callback:function(t){e.addForm=t},expression:"addForm"}},[a("el-form-item",{staticClass:"icon-area",attrs:{label:"选择banner图"}},[a("el-input",{attrs:{readonly:"",placeholder:"上传图片","auto-complete":"off"},model:{value:e.addForm.img,callback:function(t){e.$set(e.addForm,"img",t)},expression:"addForm.img"}}),e._v(" "),a("el-upload",{staticClass:"icon-uploader",attrs:{action:"/admin/ossClient/aliyunOSSUploadImage","on-success":e.handleAvatarSuccess}},[a("el-button",{attrs:{size:"small",type:"primary"}},[a("i",{staticClass:"el-icon-upload"}),e._v("上传")])],1)],1),e._v(" "),a("div",{staticClass:"inf-area"},[a("img",{staticClass:"banner-img",attrs:{src:e.addForm.imgUrl,alt:""}}),e._v(" "),a("div",{staticClass:"tips"},[e._v("建议图片尺寸350px*350px")])]),e._v(" "),a("el-form-item",{attrs:{label:"请选择类型"}},[a("el-select",{attrs:{placeholder:"请选择类型"},model:{value:e.addForm.linkType,callback:function(t){e.$set(e.addForm,"linkType",t)},expression:"addForm.linkType"}},e._l(e.linkTypeList,function(e,t){return a("el-option",{key:t,attrs:{label:e.dValue,value:e.dKey}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"请输入ID"}},[a("el-input",{attrs:{placeholder:"请输入ID","auto-complete":"off"},on:{blur:e.searchProduct},model:{value:e.addForm.linkTypeValue,callback:function(t){e.$set(e.addForm,"linkTypeValue",t)},expression:"addForm.linkTypeValue"}})],1),e._v(" "),a("div",{staticClass:"inf-area"},[e._v(e._s(e.productName))]),e._v(" "),a("el-form-item",{attrs:{label:"备注说明"}},[a("el-input",{attrs:{placeholder:"请输入备注说明","auto-complete":"off"},model:{value:e.addForm.remark,callback:function(t){e.$set(e.addForm,"remark",t)},expression:"addForm.remark"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"排序"}},[a("el-input",{attrs:{placeholder:"请输入排序","auto-complete":"off"},model:{value:e.addForm.sortRank,callback:function(t){e.$set(e.addForm,"sortRank",t)},expression:"addForm.sortRank"}})],1),e._v(" "),5!=e.pageType?a("el-form-item",{attrs:{prop:"date",label:"投放时间"}},[a("el-date-picker",{staticClass:"input-style",attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间"},model:{value:e.addForm.date,callback:function(t){e.$set(e.addForm,"date",t)},expression:"addForm.date"}})],1):e._e()],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",loading:e.btnLoading},on:{click:function(t){e.addOrEdit("addForm")}}},[e._v("确 认")]),e._v(" "),a("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.editTitle,visible:e.editMask},on:{"update:visible":function(t){e.editMask=t}}},[a("el-form",{attrs:{"label-width":"100px"},model:{value:e.form,callback:function(t){e.form=t},expression:"form"}},[a("el-form-item",{staticClass:"icon-area",attrs:{label:"选择banner图"}},[a("el-input",{attrs:{readonly:"",placeholder:"上传图片","auto-complete":"off"},model:{value:e.form.img,callback:function(t){e.$set(e.form,"img",t)},expression:"form.img"}}),e._v(" "),a("el-upload",{staticClass:"icon-uploader",attrs:{action:"/admin/ossClient/aliyunOSSUploadImage","on-success":e.handleAvatarSuccess}},[a("el-button",{attrs:{size:"small",type:"primary"}},[a("i",{staticClass:"el-icon-upload"}),e._v("上传")])],1)],1),e._v(" "),a("div",{staticClass:"inf-area"},[a("img",{staticClass:"banner-img",attrs:{src:e.form.imgUrl,alt:""}}),e._v(" "),a("div",{staticClass:"tips"},[e._v("建议图片尺寸350px*350px")])]),e._v(" "),a("el-form-item",{attrs:{label:"请选择类型"}},[a("el-select",{attrs:{placeholder:"请选择类型"},model:{value:e.form.linkType,callback:function(t){e.$set(e.form,"linkType",t)},expression:"form.linkType"}},e._l(e.linkTypeList,function(e,t){return a("el-option",{key:t,attrs:{label:e.dValue,value:e.dKey}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"请输入ID"}},[a("el-input",{attrs:{placeholder:"请输入ID","auto-complete":"off"},on:{blur:e.searchProduct},model:{value:e.form.linkTypeValue,callback:function(t){e.$set(e.form,"linkTypeValue",t)},expression:"form.linkTypeValue"}})],1),e._v(" "),a("div",{staticClass:"inf-area"},[e._v(e._s(e.productName))]),e._v(" "),a("el-form-item",{attrs:{label:"备注说明"}},[a("el-input",{attrs:{placeholder:"请输入备注说明","auto-complete":"off"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"排序"}},[a("el-input",{attrs:{placeholder:"请输入排序","auto-complete":"off"},model:{value:e.form.sortRank,callback:function(t){e.$set(e.form,"sortRank",t)},expression:"form.sortRank"}})],1),e._v(" "),5!=e.pageType?a("el-form-item",{attrs:{prop:"date",label:"投放时间"}},[a("el-date-picker",{staticClass:"input-style",attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间"},on:{blur:e.changeTime},model:{value:e.form.date,callback:function(t){e.$set(e.form,"date",t)},expression:"form.date"}})],1):e._e()],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",loading:e.btnLoading},on:{click:function(t){e.addOrEdit("form")}}},[e._v("确 认")]),e._v(" "),a("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1),e._v(" "),e.isShowDel?a("deletetoast",{attrs:{id:e.delId,url:e.delUrl,uri:e.delUri,status:3},on:{msg:e.deleteToast}}):e._e()],1)},staticRenderFns:[]};var g=a("VU/8")(u,f,!1,function(e){a("YeFt")},null,null);t.default=g.exports},YeFt:function(e,t){}});