webpackJsonp([88],{HxBr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("FMx0"),i=a("UU1J"),o=a("P9l9"),r=a("GVVA"),n=a("19nM"),d={components:{breadcrumb:s.a,icon:i.a},data:function(){return{nav:["权限管理","管理员基础信息修改"],isShowEditPwd:!1,code:!0,uploadImg:"",name:"",telephone:"",deptmentName:"",jobName:"",immediateSuperior:"",privilege:[],face:"",id:"",form:{phone:"",code:"",password:"",repeatPwd:""},rules:{phone:[{required:!0,message:"请输入电话号码",trigger:"blur"}],code:[{required:!0,message:"请输入验证码",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}}},activated:function(){var e=this;this.uploadImg=o.addImg,this.id=localStorage.getItem("ms_userID"),r.a.findAdminUserbyId({id:this.id}).then(function(t){e.name=t.data.name,e.telephone=t.data.telephone,e.deptmentName=t.data.deptmentName,e.jobName=t.data.jobName,e.immediateSuperior=t.data.immediateSuperior,e.face=t.data.face,e.privilege=[],t.data.adminUserPrivilegeList.forEach(function(t,a){e.privilege.push(t.name)})}).catch(function(e){console.log(e)})},methods:{editPwd:function(){this.form={},this.isShowEditPwd=!0},confirmEditPwd:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;if(t.form.password==t.form.repeatPwd){var a={};a.id=t.id,a.phone=t.form.phone,a.password=t.form.password,a.code=t.form.code,a.url=n.updateAdminUserPassword,t.$axios.post(o.updateAdminUserPassword,a).then(function(e){200==e.data.code?t.$message.success(e.data.msg):t.$message.warning(e.data.msg)}).catch(function(e){console.log(res.data)}),t.isShowEditPwd=!1}else t.$message.warning("两次密码输入不一致")})},uploadAvatar:function(e){var t=this,a=e.data.imageUrl;if(200==e.code){var s={};s.id=this.id,s.url=n.updateAdminUserFace,s.face=e.data.imageUrl,this.$axios.post(o.updateAdminUserFace,s).then(function(e){200==e.data.code?(t.$message.success(e.data.data),t.face=a):t.$message.warning(e.data.msg)}).catch(function(e){console.log(e)})}else this.$message.warning(e.msg)},getCode:function(){var e=this;if(""!=this.form.phone){var t=this;this.code=!1,this.codeTime=60;var a=setInterval(function(){t.codeTime--,t.codeTime<=0&&(t.code=!0,clearInterval(a))},1e3),s={};s.phone=this.form.phone,s.code="ADMIN_FIRSTLOGIN_CODE",this.$axios.post(o.sendUpdatePwdCode,s).then(function(t){200==t.data.code?e.$message.success("已发送验证码"):e.$message.warning(t.data.msg)}).catch(function(e){console.log(e)})}else this.$message.warning("请输入手机号")}}},c={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"edit-manger-msg"},[s("breadcrumb",{attrs:{nav:e.nav}}),e._v(" "),s("el-card",{attrs:{"body-style":{padding:"0px"}}},[s("div",{staticClass:"box"},[s("div",{staticClass:"detail-msg"},[s("span",[e._v("基础信息")]),e._v(" "),s("p",[e._v("姓名："+e._s(e.name))]),e._v(" "),s("p",[e._v("手机号："+e._s(e.telephone))]),e._v(" "),s("span",[e._v("部门信息")]),e._v(" "),s("p",[e._v("所属部门："+e._s(e.deptmentName))]),e._v(" "),s("p",[e._v("所在岗位："+e._s(e.jobName))]),e._v(" "),s("p",[e._v("直接上级："+e._s(e.immediateSuperior))]),e._v(" "),s("span",[e._v("权限信息")]),e._v(" "),s("p",[e._v("默认权限："),e._l(e.privilege,function(t,a){return s("el-tag",{key:a,staticStyle:{"margin-right":"5px"}},[e._v(e._s(t))])})],2),e._v(" "),s("div",{staticClass:"avatar"},[s("img",{attrs:{src:e.face,alt:""}})]),e._v(" "),s("el-upload",{staticClass:"avatar",attrs:{action:e.uploadImg,"show-file-list":!1,"on-success":e.uploadAvatar}},[""==e.face?s("img",{attrs:{src:a("odpv"),alt:""}}):s("img",{attrs:{src:e.face,alt:""}})]),e._v(" "),s("el-button",{staticClass:"edit-btn",attrs:{type:"primary"},on:{click:e.editPwd}},[e._v("登陆密码修改")])],1)])]),e._v(" "),s("el-dialog",{attrs:{title:"登陆密码修改",width:"600px",visible:e.isShowEditPwd},on:{"update:visible":function(t){e.isShowEditPwd=t}}},[s("div",{staticClass:"toask-wrap"},[s("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules}},[s("el-form-item",{attrs:{prop:"phone"}},[s("el-input",{staticClass:"edit-pwd-inp",attrs:{size:"large",placeholder:"请输入手机号"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}},[s("icon",{staticClass:"inp-ico",attrs:{slot:"prefix",ico:"icon-zhucedengluyonghuming"},slot:"prefix"})],1)],1),e._v(" "),s("el-form-item",{attrs:{prop:"code"}},[s("el-input",{staticClass:"edit-pwd-inp",attrs:{size:"large",placeholder:"请输入验证码"},model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}},[s("icon",{staticClass:"inp-ico ",attrs:{slot:"prefix",ico:"icon-yanzhengma"},slot:"prefix"})],1)],1),e._v(" "),s("el-form-item",{attrs:{prop:"password"}},[s("el-input",{staticClass:"edit-pwd-inp",attrs:{size:"large",placeholder:"请重新设置您的密码"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}},[s("icon",{staticClass:"inp-ico ",attrs:{slot:"prefix",ico:"icon-3denglumima"},slot:"prefix"})],1)],1),e._v(" "),s("el-form-item",{attrs:{prop:"repeatPwd"}},[s("el-input",{staticClass:"edit-pwd-inp",attrs:{size:"large",placeholder:"请再次输入您的密码"},model:{value:e.form.repeatPwd,callback:function(t){e.$set(e.form,"repeatPwd",t)},expression:"form.repeatPwd"}},[s("icon",{staticClass:"inp-ico ",attrs:{slot:"prefix",ico:"icon-3denglumima"},slot:"prefix"})],1)],1)],1),e._v(" "),e.code?s("el-button",{staticClass:"code-btn",attrs:{type:"primary"},on:{click:e.getCode}},[e._v("获取验证码")]):s("el-button",{staticClass:"code-btn",attrs:{type:"primary"}},[e._v(e._s(e.codeTime)+"s")])],1),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:function(t){e.confirmEditPwd("form")}}},[e._v("确 定")]),e._v(" "),s("el-button",{on:{click:function(t){e.isShowEditPwd=!1}}},[e._v("取 消")])],1)])],1)},staticRenderFns:[]};var l=a("VU/8")(d,c,!1,function(e){a("n6PI")},null,null);t.default=l.exports},n6PI:function(e,t){}});