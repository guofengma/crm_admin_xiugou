webpackJsonp([93],{K6HQ:function(e,t){},"R4+R":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("FMx0"),n=a("P9l9"),r=a("19nM"),l={components:{breadcrumb:s.a},data:function(){return{nav:["权限管理","岗位权限管理","添加岗位"],checkAllUser:[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],isIndeterminateUser:!1,checkedUser:[[],[],[],[],[],[],[],[],[],[]],userManList:[],department:[],form:{department:[],name:""},rules:{name:{required:!0,message:"请选择所在岗位",trigger:"blur"},department:{required:!0,message:"请选择所属部门",trigger:"blur"}}}},activated:function(){this.form.department=[],this.form.name="",this.checkAllUser=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],this.getDepartmentList(),this.getRoleList()},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;var a={},s=[];t.checkedUser.forEach(function(e,t){e.forEach(function(e){s.push(e)})}),a.role=s.join(","),a.name=t.form.name,a.department=t.form.department.join(","),a.url=r.addRole,t.$axios.post(n.addRole,a).then(function(e){200==e.data.code?(t.$message.success(e.data.data),t.$router.push("/jobsPermissionMange")):t.$message.warning(e.data.msg)}).catch(function(e){console.log(e)})})},goBack:function(){this.$router.push("/jobsPermissionMange")},handleCheckAllChangeUser:function(e,t){var a=[];this.userManList[t].value.forEach(function(e){e.value.forEach(function(e){a.push(e.id)})}),this.checkedUser[t]=e?a:[]},handleCheckedUserChange:function(e,t){var a=[],s=e.length;this.userManList[t].value.forEach(function(e){e.value.forEach(function(e){a.push(e.value)})}),this.checkAllUser[t]=s==a.length,this.$set(this.checkAllUser,t,this.checkAllUser[t])},getRoleList:function(){var e=this;this.$axios.post(n.getRoleList,{}).then(function(t){e.userManList=t.data.data}).catch(function(e){console.log(e)})},getDepartmentList:function(){var e=this;this.department=[],this.$axios.post(n.queryDepartmentList,{}).then(function(t){200==t.data.code?t.data.data.forEach(function(t,a){e.department.push({label:t.name,value:t.id})}):e.$message.warning(t.data.msg)}).catch(function(e){console.log(e)})}}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("breadcrumb",{attrs:{nav:e.nav}}),e._v(" "),a("el-card",[a("div",{staticClass:"add-box"},[a("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"100px"}},[a("span",{staticClass:"add-box-title"},[e._v("基础信息")]),e._v(" "),a("el-form-item",{attrs:{prop:"name",label:"所在岗位"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"请选择"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"department",label:"所属部门"}},[a("el-select",{attrs:{multiple:"",placeholder:"请选择"},model:{value:e.form.department,callback:function(t){e.$set(e.form,"department",t)},expression:"form.department"}},e._l(e.department,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("hr",{staticClass:"add-box-sep",attrs:{width:"90%",size:"1",color:"#ccc"}}),e._v(" "),a("span",{staticClass:"add-box-title"},[e._v("权限设置")]),e._v(" "),e._l(e.userManList,function(t,s){return a("el-collapse",{key:s,attrs:{accordion:""}},[a("el-collapse-item",[a("template",{slot:"title"},[a("el-checkbox",{staticClass:"collapse-tit",on:{change:function(t){e.handleCheckAllChangeUser(e.checkAllUser[s],s)}},model:{value:e.checkAllUser[s],callback:function(t){e.$set(e.checkAllUser,s,t)},expression:"checkAllUser[k]"}},[e._v(e._s(t.title))])],1),e._v(" "),a("el-checkbox-group",{on:{change:function(t){e.handleCheckedUserChange(e.checkedUser[s],s)}},model:{value:e.checkedUser[s],callback:function(t){e.$set(e.checkedUser,s,t)},expression:"checkedUser[k]"}},e._l(t.value,function(t,s){return a("div",{key:s},[a("div",{staticClass:"collapse-title"},[e._v(e._s(t.title))]),e._v(" "),a("div",{staticStyle:{overflow:"hidden","margin-bottom":"10px"}},[a("div",{staticClass:"collapse-item"},e._l(t.value,function(t,s){return a("el-checkbox",{key:s,attrs:{label:t.id}},[e._v(e._s(t.title))])}))])])}))],2)],1)}),e._v(" "),a("el-form-item",{staticClass:"sub-btn"},[a("el-button",{attrs:{size:"medium",type:"primary"},on:{click:function(t){e.submitForm("form")}}},[e._v("提交")]),e._v(" "),a("el-button",{attrs:{size:"medium"},on:{click:e.goBack}},[e._v("取消")])],1)],2)],1)])],1)},staticRenderFns:[]};var o=a("VU/8")(l,c,!1,function(e){a("K6HQ")},null,null);t.default=o.exports}});