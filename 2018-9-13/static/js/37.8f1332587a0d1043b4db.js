webpackJsonp([37],{IoEK:function(t,e){},"Jj/Z":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("FMx0"),o=a("mvHQ"),i=a.n(o),s=a("GVVA"),n={props:["name"],components:{},mixins:[a("xnHa").b],data:function(){return{itemList:[],defItem:[],itemProps:{value:"value",children:"children"},status:"",form:{productName:"",prodCode:"",barCode:"",firstCategoryId:"",secCategoryId:"",thirdCategoryId:"",salesMin:"",salesMax:"",priceMin:"",priceMax:""},tableData:[],tableLoading:!1,isShowPop:!1,multipleSelection:[],brandId:"",supplierId:"",firstCategoryId:"",secCategoryId:"",brand_id:"",flag:""}},activated:function(){this.brandId=this.$route.query.brandId||sessionStorage.getItem("brandId"),this.supplierId=this.$route.query.supplierId||sessionStorage.getItem("supplierId"),this.firstCategoryId=this.$route.query.firstCategoryId||sessionStorage.getItem("firstCategoryId"),this.secCategoryId=this.$route.query.secCategoryId||sessionStorage.getItem("secCategoryId"),this.brand_id=this.$route.query.brand_id||sessionStorage.getItem("brand_id"),this.flag=this.$route.query.flag||sessionStorage.getItem("flag"),this.flag&&(this.status="4"),this.getList(1)},mounted:function(){var t=this.name;this.brandId=this.$route.query.brandId||sessionStorage.getItem("brandId"),this.supplierId=this.$route.query.supplierId||sessionStorage.getItem("supplierId"),this.firstCategoryId=this.$route.query.firstCategoryId||sessionStorage.getItem("firstCategoryId"),this.secCategoryId=this.$route.query.secCategoryId||sessionStorage.getItem("secCategoryId"),this.brand_id=this.$route.query.brand_id||sessionStorage.getItem("brand_id"),this.flag=this.$route.query.flag||sessionStorage.getItem("flag"),this.flag&&(this.status="4"),"allProduct"===t?this.status="":"upProduct"===t?this.status="4":"downProduct"===t?this.status="5":"auditProduct"===t?this.status="1":"modifyProduct"===t&&(this.status="3"),this.getFirstItem(),this.getList(1)},methods:{getList:function(t){var e=this,a={};(a=this.form).page=t,a.statusParam=this.status,this.flag?0==this.flag?(a.supplierId=this.supplierId,a.firstCategoryId=this.firstCategoryId,a.secCategoryId=this.secCategoryId,a.brandId=""):1==this.flag?(a.supplierId=this.supplierId,a.brandId=this.brand_id,a.firstCategoryId="",a.secCategoryId=""):(a.brandId=this.brandId,a.firstCategoryId="",a.secCategoryId="",a.supplierId=""):(a.firstCategoryId=this.form.firstCategoryId,a.secCategoryId=this.form.secCategoryId,a.supplierId="",a.brandId=""),this.tableLoading=!0,s.a.queryProductPageList({productPageParamVO:a}).then(function(t){e.tableLoading=!1}).catch(function(t){console.log(t),e.tableLoading=!1})},resetForm:function(t){this.form.salesMax="",this.form.priceMax="",this.form.firstCategoryId="",this.form.secCategoryId="",this.form.thirdCategoryId="",this.defItem=[],this.$refs[t].resetFields(),this.getList(1)},handleSelectionChange:function(t){var e=this;this.multipleSelection=[],t.forEach(function(t,a){e.multipleSelection.push(t.id)})},releaseProduct:function(){this.$router.push({name:"releaseProduct"})},editProduct:function(t){sessionStorage.setItem("releaseProduct",t.id),this.$router.push({name:"editProduct",query:{releaseProductId:t.id}})},specificationsManage:function(t){var e=[];e.push(t.sec_category_id),e.push(t.id),sessionStorage.setItem("productSpecifications",i()(e)),this.$router.push({name:"productSpecifications",query:{releaseProductId:i()(e)}})},priceManage:function(t){sessionStorage.setItem("priceManage",t.id),this.$router.push({name:"priceManage",query:{priceManageId:t.id}})},inventoryManage:function(t){sessionStorage.setItem("productInventory",t.id),this.$router.push({name:"productInventory",query:{productInventoryId:t.id}})},productStatus:function(t,e){var a=this,r={};r.productId=t.id,r.status=e,r.url=pApi.updateProductShelves,this.$axios.post(api.updateProductShelves,r).then(function(r){a.$message.success(r.data.data),t.status=e,a.getList(a.page.currentPage)}).catch(function(t){console.log(t)})},auditProduct:function(t,e){var a=this,r={};r.productId=t.id,r.status=e,r.url=pApi.updateProductStatus,this.$axios.post(api.updateProductStatus,r).then(function(r){t.status=e,a.$message.success(r.data.data),a.getList(a.page.currentPage)}).catch(function(t){console.log(t)})},productInfo:function(t){sessionStorage.setItem("productInfo",t.id),this.$router.push({name:"productInfo",query:{productInfoId:t.id}})},getFirstItem:function(){var t=this;this.itemList=[],s.a.queryProductCategoryList({fatherId:0,level:1,pageSize:1e5}).then(function(e){e.data.data.forEach(function(e,a){t.itemList.push({label:e.name,value:e.id,children:[]})})}).catch(function(t){console.log(t)})},handleItemChange:function(t){var e=this,a=0,r={pageSize:1e5};if(t[1]){var o=0;this.itemList.forEach(function(e,r){e.value==t[0]&&(o=r,e.children.forEach(function(e,r){e.value==t[1]&&(a=r)}))}),r.fatherId=t[1],r.level=3,s.a.queryProductCategoryList(r).then(function(t){e.itemList[o].children[a].children=[],t.data.data.forEach(function(t,r){e.itemList[o].children[a].children.push({label:t.name,value:t.id})})}).catch(function(t){console.log(t)})}else this.itemList.forEach(function(e,r){e.value==t[0]&&(a=r)}),r.fatherId=t[0],r.level=2,s.a.queryProductCategoryList(r).then(function(t){e.itemList[a].children=[],t.data.data.forEach(function(t,r){e.itemList[a].children.push({label:t.name,value:t.id,children:[]})})}).catch(function(t){console.log(t)})},getProItemId:function(t){this.form.firstCategoryId=t[0],this.form.secCategoryId=t[1],this.form.thirdCategoryId=t[2]},batchOperate:function(t){var e=this,a={};a.ids=this.multipleSelection.join(","),a.status=t,this.$axios.post(api.updateBatchProductStatus,a).then(function(t){e.$message.success(t.data.data),e.isShowPop=!1,e.getList(e.page.currentPage)}).catch(function(t){console.log(t)})}},filters:{formatPrice:function(t){return"￥"+t}}},c={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tab-content"},[a("el-button",{staticClass:"add-product",attrs:{type:"primary"},on:{click:t.releaseProduct}},[t._v("添加产品")]),t._v(" "),a("div",{staticClass:"search-pane"},[a("el-form",{ref:"form",attrs:{model:t.form,inline:"","label-width":"100px"}},[a("el-form-item",{attrs:{prop:"name",label:"产品名称"}},[a("el-input",{attrs:{placeholder:"请输入产品名称"},model:{value:t.form.productName,callback:function(e){t.$set(t.form,"productName","string"==typeof e?e.trim():e)},expression:"form.productName"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"prodCode",label:"产品ID号"}},[a("el-input",{attrs:{placeholder:"请输入产品ID"},model:{value:t.form.prodCode,callback:function(e){t.$set(t.form,"prodCode","string"==typeof e?e.trim():e)},expression:"form.prodCode"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"barCode",label:"条形码"}},[a("el-input",{attrs:{placeholder:"请输入条形码"},model:{value:t.form.barCode,callback:function(e){t.$set(t.form,"barCode","string"==typeof e?e.trim():e)},expression:"form.barCode"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"item",label:"产品类目"}},[a("el-cascader",{attrs:{options:t.itemList,props:t.itemProps},on:{change:t.getProItemId,"active-item-change":t.handleItemChange},model:{value:t.defItem,callback:function(e){t.defItem=e},expression:"defItem"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"saleMin",label:"总销量"}},[a("el-input",{staticStyle:{width:"95px"},model:{value:t.form.salesMin,callback:function(e){t.$set(t.form,"salesMin","string"==typeof e?e.trim():e)},expression:"form.salesMin"}}),t._v("\n                -\n                "),a("el-input",{staticStyle:{width:"95px"},model:{value:t.form.salesMax,callback:function(e){t.$set(t.form,"salesMax","string"==typeof e?e.trim():e)},expression:"form.salesMax"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"priceMin",label:"价格"}},[a("el-input",{staticStyle:{width:"95px"},model:{value:t.form.priceMin,callback:function(e){t.$set(t.form,"priceMin","string"==typeof e?e.trim():e)},expression:"form.priceMin"}},[a("template",{slot:"prepend"},[t._v("￥")])],2),t._v("\n                -\n                "),a("el-input",{staticStyle:{width:"95px"},model:{value:t.form.priceMax,callback:function(e){t.$set(t.form,"priceMax","string"==typeof e?e.trim():e)},expression:"form.priceMax"}},[a("template",{slot:"prepend"},[t._v("￥")])],2)],1),t._v(" "),a("el-form-item",{attrs:{label:" "}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.getList(1)}}},[t._v("搜索")]),t._v(" "),a("el-button",{on:{click:function(e){t.resetForm("form")}}},[t._v("重置")])],1)],1)],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],attrs:{border:"",data:t.tableData},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"产品名称","min-width":"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"product-img"},[a("img",{attrs:{src:e.row.img_url}})]),t._v(" "),a("p",{staticClass:"product-name"},[t._v(t._s(e.row.name))]),t._v(" "),a("p",{staticClass:"product-id"},[t._v("产品ID："+t._s(e.row.prod_code))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"产品类目",align:"center","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                "+t._s(e.row.firstName)),a("br"),t._v(t._s(e.row.secondName)+"\n            ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"产品售价",align:"center","min-width":"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                "+t._s(t._f("formatPrice")(void 0==e.row.original_price?"0":e.row.original_price))+"\n            ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"stock",label:"库存",align:"center","min-width":"50"}}),t._v(" "),a("el-table-column",{attrs:{prop:"saleNum",label:"销量",align:"center","min-width":"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                "+t._s(e.row.saleNum||0)+"\n            ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"发布时间/发布人",align:"center","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                "+t._s(t._f("formatDate")(e.row.create_time))),a("br"),t._v(t._s("产品编辑:"+e.row.create_admin)+"\n            ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"",label:"状态",align:"center","min-width":"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.status?[t._v("待审核")]:2==e.row.status?[t._v("已通过")]:3==e.row.status?[t._v("未通过")]:4==e.row.status?[t._v("已上架")]:5==e.row.status?[t._v("停用")]:6==e.row.status?[t._v("删除")]:t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作","min-width":"220"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"operate"},[a("el-button",{attrs:{type:"primary"},on:{click:function(a){t.inventoryManage(e.row)}}},[t._v("\n                        库存管理\n                    ")]),t._v(" "),4!=e.row.status?a("el-button",{attrs:{type:"primary"},on:{click:function(a){t.specificationsManage(e.row)}}},[t._v("\n                        规格管理\n                    ")]):t._e(),t._v(" "),4!=e.row.status?a("el-button",{attrs:{type:"primary"},on:{click:function(a){t.priceManage(e.row)}}},[t._v("价格管理\n                    ")]):t._e(),t._v(" "),1!=e.row.status&&5!=e.row.status||"auditProduct"!=t.name?[4!=e.row.status&&2!=e.row.status?a("el-button",{attrs:{type:"success"},on:{click:function(a){t.editProduct(e.row)}}},[t._v("编辑产品\n                        ")]):t._e(),t._v(" "),[4==e.row.status?a("el-button",{attrs:{type:"warning"},on:{click:function(a){t.productStatus(e.row,"5")}}},[t._v("产品下架\n                            ")]):2==e.row.status?a("el-button",{attrs:{type:"warning"},on:{click:function(a){t.productStatus(e.row,"4")}}},[t._v("产品上架\n                            ")]):t._e(),t._v(" "),5==e.row.status?a("el-button",{attrs:{type:"warning"},on:{click:function(a){t.productStatus(e.row,"4")}}},[t._v("产品上架\n                            ")]):t._e()]]:[a("el-button",{attrs:{type:"primary"},on:{click:function(a){t.auditProduct(e.row,2)}}},[t._v("通过审核")]),t._v(" "),a("el-button",{attrs:{type:"danger"},on:{click:function(a){t.auditProduct(e.row,3)}}},[t._v("驳回审核")])],t._v(" "),t.p.findProductById?a("el-button",{attrs:{type:"primary"},on:{click:function(a){t.productInfo(e.row)}}},[t._v("查看详情\n                    ")]):t._e()],2)]}}])})],1),t._v(" "),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{background:"","current-page":t.page.currentPage,layout:"total, prev, pager, next, jumper",total:t.page.totalPage},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),t._v(" "),a("div",{staticClass:"operate-table"},[a("el-popover",{attrs:{placement:"top",width:"160"},model:{value:t.isShowPop,callback:function(e){t.isShowPop=e},expression:"isShowPop"}},[a("p",[t._v("确定删除吗？")]),t._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.batchOperate("6")}}},[t._v("确定")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t.isShowPop=!1}}},[t._v("取消")])],1),t._v(" "),a("el-button",{attrs:{slot:"reference"},on:{click:function(e){t.isShowPop=!0}},slot:"reference"},[t._v("删除")])],1),t._v(" "),a("el-button",{on:{click:function(e){t.batchOperate("5")}}},[t._v("下架")])],1)],1)},staticRenderFns:[]};var l=a("VU/8")(n,c,!1,function(t){a("IoEK")},null,null).exports,u={components:{vBreadcrumb:r.a,vTabContent:l},data:function(){return{nav:["品牌产品管理","产品管理"],activeName:"allProduct"}},activated:function(){this.flag=this.$route.query.flag||sessionStorage.getItem("flag"),this.flag?this.activeName="upProduct":this.activeName="allProduct"},beforeRouteLeave:function(t,e,a){sessionStorage.removeItem("flag"),a()},methods:{handleClick:function(t){this.tabName=t.name}}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"product-list"},[a("v-breadcrumb",{attrs:{nav:t.nav}}),t._v(" "),a("el-card",{attrs:{"body-style":{padding:"30px 45px",minHeight:"80vh"}}},[a("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"全部产品",name:"allProduct"}},["allProduct"==t.activeName?a("v-tab-content",{attrs:{name:t.activeName}}):t._e()],1),t._v(" "),a("el-tab-pane",{attrs:{label:"上架产品",name:"upProduct"}},["upProduct"==t.activeName?a("v-tab-content",{attrs:{name:t.activeName}}):t._e()],1),t._v(" "),a("el-tab-pane",{attrs:{label:"下架产品",name:"downProduct"}},["downProduct"==t.activeName?a("v-tab-content",{attrs:{name:t.activeName}}):t._e()],1),t._v(" "),a("el-tab-pane",{attrs:{label:"审核产品",name:"auditProduct"}},["auditProduct"==t.activeName?a("v-tab-content",{attrs:{name:t.activeName}}):t._e()],1)],1)],1)],1)},staticRenderFns:[]};var p=a("VU/8")(u,d,!1,function(t){a("JwpI")},null,null);e.default=p.exports},JwpI:function(t,e){}});